
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://py.iceberg.apache.org/reference/pyiceberg/expressions/visitors/">
      
      
        <link rel="prev" href="../parser/">
      
      
        <link rel="next" href="../../io/">
      
      
      <link rel="icon" href="../../../../assets/images/iceberg-logo-icon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.5">
    
    
      
        <title>visitors - PyIceberg</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Lato";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pyiceberg.expressions.visitors" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="PyIceberg" class="md-header__button md-logo" aria-label="PyIceberg" data-md-component="logo">
      
  <img src="../../../../assets/images/iceberg-logo-icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyIceberg
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              visitors
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/apache/iceberg-python" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    apache/iceberg-python
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
    
  
  Getting started

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../configuration/" class="md-tabs__link">
        
  
    
  
  Configuration

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../cli/" class="md-tabs__link">
        
  
    
  
  CLI

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../api/" class="md-tabs__link">
        
  
    
  
  API

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../contributing/" class="md-tabs__link">
        
  
    
  
  Contributing

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../community/" class="md-tabs__link">
        
  
    
  
  Community

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../verify-release/" class="md-tabs__link">
          
  
  Releases

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  Code Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="PyIceberg" class="md-nav__button md-logo" aria-label="PyIceberg" data-md-component="logo">
      
  <img src="../../../../assets/images/iceberg-logo-icon.png" alt="logo">

    </a>
    PyIceberg
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/apache/iceberg-python" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    apache/iceberg-python
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CLI
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../community/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Community
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Releases
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Releases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../verify-release/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Verify a release
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../how-to-release/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to release
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/apache/iceberg-python/releases" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../nightly-build/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nightly Build
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Code Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    pyiceberg
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8_1" id="__nav_8_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8_1">
            <span class="md-nav__icon md-icon"></span>
            pyiceberg
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../avro/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    avro
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8_1_1" id="__nav_8_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_1_1">
            <span class="md-nav__icon md-icon"></span>
            avro
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../avro/codecs/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    codecs
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8_1_1_1" id="__nav_8_1_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            codecs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../avro/codecs/bzip2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bzip2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../avro/codecs/codec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    codec
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../avro/codecs/deflate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    deflate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../avro/codecs/snappy_codec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    snappy_codec
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../avro/codecs/zstandard_codec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    zstandard_codec
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../avro/decoder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    decoder
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../avro/encoder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    encoder
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../avro/file/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    file
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../avro/reader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    reader
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../avro/resolver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    resolver
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../avro/writer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    writer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../catalog/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    catalog
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8_1_2" id="__nav_8_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_1_2">
            <span class="md-nav__icon md-icon"></span>
            catalog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../catalog/dynamodb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dynamodb
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../catalog/glue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    glue
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../catalog/hive/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hive
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../catalog/memory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    memory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../catalog/noop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    noop
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../catalog/rest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rest
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../catalog/sql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sql
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cli/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    cli
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8_1_3" id="__nav_8_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_1_3">
            <span class="md-nav__icon md-icon"></span>
            cli
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/console/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    console
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    output
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conversions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    conversions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exceptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exceptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_6" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    expressions
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8_1_6" id="__nav_8_1_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_1_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8_1_6">
            <span class="md-nav__icon md-icon"></span>
            expressions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../literals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    literals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../parser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    parser
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    visitors
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    visitors
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors" class="md-nav__link">
    <span class="md-ellipsis">
      visitors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BindVisitor" class="md-nav__link">
    <span class="md-ellipsis">
      BindVisitor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor" class="md-nav__link">
    <span class="md-ellipsis">
      BooleanExpressionVisitor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BooleanExpressionVisitor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_and" class="md-nav__link">
    <span class="md-ellipsis">
      visit_and
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_bound_predicate" class="md-nav__link">
    <span class="md-ellipsis">
      visit_bound_predicate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_false" class="md-nav__link">
    <span class="md-ellipsis">
      visit_false
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_not" class="md-nav__link">
    <span class="md-ellipsis">
      visit_not
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_or" class="md-nav__link">
    <span class="md-ellipsis">
      visit_or
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_true" class="md-nav__link">
    <span class="md-ellipsis">
      visit_true
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_unbound_predicate" class="md-nav__link">
    <span class="md-ellipsis">
      visit_unbound_predicate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor" class="md-nav__link">
    <span class="md-ellipsis">
      BoundBooleanExpressionVisitor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BoundBooleanExpressionVisitor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_and" class="md-nav__link">
    <span class="md-ellipsis">
      visit_and
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_bound_predicate" class="md-nav__link">
    <span class="md-ellipsis">
      visit_bound_predicate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_equal" class="md-nav__link">
    <span class="md-ellipsis">
      visit_equal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_false" class="md-nav__link">
    <span class="md-ellipsis">
      visit_false
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_greater_than" class="md-nav__link">
    <span class="md-ellipsis">
      visit_greater_than
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_greater_than_or_equal" class="md-nav__link">
    <span class="md-ellipsis">
      visit_greater_than_or_equal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_in" class="md-nav__link">
    <span class="md-ellipsis">
      visit_in
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_is_nan" class="md-nav__link">
    <span class="md-ellipsis">
      visit_is_nan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_is_null" class="md-nav__link">
    <span class="md-ellipsis">
      visit_is_null
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_less_than" class="md-nav__link">
    <span class="md-ellipsis">
      visit_less_than
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_less_than_or_equal" class="md-nav__link">
    <span class="md-ellipsis">
      visit_less_than_or_equal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not" class="md-nav__link">
    <span class="md-ellipsis">
      visit_not
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not_equal" class="md-nav__link">
    <span class="md-ellipsis">
      visit_not_equal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not_in" class="md-nav__link">
    <span class="md-ellipsis">
      visit_not_in
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not_nan" class="md-nav__link">
    <span class="md-ellipsis">
      visit_not_nan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not_null" class="md-nav__link">
    <span class="md-ellipsis">
      visit_not_null
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not_starts_with" class="md-nav__link">
    <span class="md-ellipsis">
      visit_not_starts_with
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_or" class="md-nav__link">
    <span class="md-ellipsis">
      visit_or
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_starts_with" class="md-nav__link">
    <span class="md-ellipsis">
      visit_starts_with
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_true" class="md-nav__link">
    <span class="md-ellipsis">
      visit_true
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_unbound_predicate" class="md-nav__link">
    <span class="md-ellipsis">
      visit_unbound_predicate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.ResidualVisitor" class="md-nav__link">
    <span class="md-ellipsis">
      ResidualVisitor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ResidualVisitor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.ResidualVisitor.visit_bound_predicate" class="md-nav__link">
    <span class="md-ellipsis">
      visit_bound_predicate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors._ColumnNameTranslator" class="md-nav__link">
    <span class="md-ellipsis">
      _ColumnNameTranslator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors._ExpressionFieldIDs" class="md-nav__link">
    <span class="md-ellipsis">
      _ExpressionFieldIDs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors._InclusiveMetricsEvaluator" class="md-nav__link">
    <span class="md-ellipsis">
      _InclusiveMetricsEvaluator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="_InclusiveMetricsEvaluator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors._InclusiveMetricsEvaluator.eval" class="md-nav__link">
    <span class="md-ellipsis">
      eval
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors._RewriteNotVisitor" class="md-nav__link">
    <span class="md-ellipsis">
      _RewriteNotVisitor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors._StrictMetricsEvaluator" class="md-nav__link">
    <span class="md-ellipsis">
      _StrictMetricsEvaluator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="_StrictMetricsEvaluator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors._StrictMetricsEvaluator.eval" class="md-nav__link">
    <span class="md-ellipsis">
      eval
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.bind" class="md-nav__link">
    <span class="md-ellipsis">
      bind
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.expression_to_plain_format" class="md-nav__link">
    <span class="md-ellipsis">
      expression_to_plain_format
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.visit" class="md-nav__link">
    <span class="md-ellipsis">
      visit
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../io/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    io
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8_1_7" id="__nav_8_1_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_1_7">
            <span class="md-nav__icon md-icon"></span>
            io
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../io/fsspec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fsspec
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../io/pyarrow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pyarrow
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../manifest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    manifest
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../partitioning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    partitioning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    schema
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../serializers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    serializers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_12" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../table/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    table
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8_1_12" id="__nav_8_1_12_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_1_12">
            <span class="md-nav__icon md-icon"></span>
            table
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../table/inspect/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    inspect
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../table/locations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    locations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../table/metadata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    metadata
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../table/name_mapping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    name_mapping
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../table/refs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    refs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../table/snapshots/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    snapshots
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../table/sorting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sorting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../table/statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    statistics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_12_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../table/update/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    update
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8_1_12_9" id="__nav_8_1_12_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_1_12_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_1_12_9">
            <span class="md-nav__icon md-icon"></span>
            update
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../table/update/schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    schema
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../table/update/snapshot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    snapshot
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../table/update/spec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spec
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../table/update/statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    statistics
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../table/upsert_util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upsert_util
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transforms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    transforms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../typedef/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    typedef
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_16" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../utils/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8_1_16" id="__nav_8_1_16_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_1_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_1_16">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/bin_packing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bin_packing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/concurrent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    concurrent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/datetime/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datetime
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/decimal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    decimal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/deprecated/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    deprecated
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/lazydict/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lazydict
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/parsing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    parsing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/properties/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    properties
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/schema_conversion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    schema_conversion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/singleton/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    singleton
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/truncate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    truncate
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors" class="md-nav__link">
    <span class="md-ellipsis">
      visitors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BindVisitor" class="md-nav__link">
    <span class="md-ellipsis">
      BindVisitor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor" class="md-nav__link">
    <span class="md-ellipsis">
      BooleanExpressionVisitor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BooleanExpressionVisitor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_and" class="md-nav__link">
    <span class="md-ellipsis">
      visit_and
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_bound_predicate" class="md-nav__link">
    <span class="md-ellipsis">
      visit_bound_predicate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_false" class="md-nav__link">
    <span class="md-ellipsis">
      visit_false
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_not" class="md-nav__link">
    <span class="md-ellipsis">
      visit_not
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_or" class="md-nav__link">
    <span class="md-ellipsis">
      visit_or
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_true" class="md-nav__link">
    <span class="md-ellipsis">
      visit_true
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_unbound_predicate" class="md-nav__link">
    <span class="md-ellipsis">
      visit_unbound_predicate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor" class="md-nav__link">
    <span class="md-ellipsis">
      BoundBooleanExpressionVisitor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BoundBooleanExpressionVisitor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_and" class="md-nav__link">
    <span class="md-ellipsis">
      visit_and
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_bound_predicate" class="md-nav__link">
    <span class="md-ellipsis">
      visit_bound_predicate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_equal" class="md-nav__link">
    <span class="md-ellipsis">
      visit_equal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_false" class="md-nav__link">
    <span class="md-ellipsis">
      visit_false
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_greater_than" class="md-nav__link">
    <span class="md-ellipsis">
      visit_greater_than
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_greater_than_or_equal" class="md-nav__link">
    <span class="md-ellipsis">
      visit_greater_than_or_equal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_in" class="md-nav__link">
    <span class="md-ellipsis">
      visit_in
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_is_nan" class="md-nav__link">
    <span class="md-ellipsis">
      visit_is_nan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_is_null" class="md-nav__link">
    <span class="md-ellipsis">
      visit_is_null
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_less_than" class="md-nav__link">
    <span class="md-ellipsis">
      visit_less_than
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_less_than_or_equal" class="md-nav__link">
    <span class="md-ellipsis">
      visit_less_than_or_equal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not" class="md-nav__link">
    <span class="md-ellipsis">
      visit_not
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not_equal" class="md-nav__link">
    <span class="md-ellipsis">
      visit_not_equal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not_in" class="md-nav__link">
    <span class="md-ellipsis">
      visit_not_in
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not_nan" class="md-nav__link">
    <span class="md-ellipsis">
      visit_not_nan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not_null" class="md-nav__link">
    <span class="md-ellipsis">
      visit_not_null
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not_starts_with" class="md-nav__link">
    <span class="md-ellipsis">
      visit_not_starts_with
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_or" class="md-nav__link">
    <span class="md-ellipsis">
      visit_or
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_starts_with" class="md-nav__link">
    <span class="md-ellipsis">
      visit_starts_with
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_true" class="md-nav__link">
    <span class="md-ellipsis">
      visit_true
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_unbound_predicate" class="md-nav__link">
    <span class="md-ellipsis">
      visit_unbound_predicate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.ResidualVisitor" class="md-nav__link">
    <span class="md-ellipsis">
      ResidualVisitor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ResidualVisitor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.ResidualVisitor.visit_bound_predicate" class="md-nav__link">
    <span class="md-ellipsis">
      visit_bound_predicate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors._ColumnNameTranslator" class="md-nav__link">
    <span class="md-ellipsis">
      _ColumnNameTranslator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors._ExpressionFieldIDs" class="md-nav__link">
    <span class="md-ellipsis">
      _ExpressionFieldIDs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors._InclusiveMetricsEvaluator" class="md-nav__link">
    <span class="md-ellipsis">
      _InclusiveMetricsEvaluator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="_InclusiveMetricsEvaluator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors._InclusiveMetricsEvaluator.eval" class="md-nav__link">
    <span class="md-ellipsis">
      eval
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors._RewriteNotVisitor" class="md-nav__link">
    <span class="md-ellipsis">
      _RewriteNotVisitor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors._StrictMetricsEvaluator" class="md-nav__link">
    <span class="md-ellipsis">
      _StrictMetricsEvaluator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="_StrictMetricsEvaluator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors._StrictMetricsEvaluator.eval" class="md-nav__link">
    <span class="md-ellipsis">
      eval
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.bind" class="md-nav__link">
    <span class="md-ellipsis">
      bind
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.expression_to_plain_format" class="md-nav__link">
    <span class="md-ellipsis">
      expression_to_plain_format
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyiceberg.expressions.visitors.visit" class="md-nav__link">
    <span class="md-ellipsis">
      visit
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>visitors</h1>

<div class="doc doc-object doc-module">



<a id="pyiceberg.expressions.visitors"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="pyiceberg.expressions.visitors.BindVisitor" class="doc doc-heading">
            <code>BindVisitor</code>


<a href="#pyiceberg.expressions.visitors.BindVisitor" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="pyiceberg.expressions.visitors.BooleanExpressionVisitor" href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor">BooleanExpressionVisitor</a>[<a class="autorefs autorefs-internal" title="pyiceberg.expressions.BooleanExpression" href="../#pyiceberg.expressions.BooleanExpression">BooleanExpression</a>]</code></p>


        <p>Rewrites a boolean expression by replacing unbound references with references to fields in a struct schema.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="pyiceberg.schema.Schema" href="../../schema/#pyiceberg.schema.Schema">Schema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A schema to use when binding the expression.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>case_sensitive</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to consider case when binding a reference to a field in a schema, defaults to True.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>In the case a predicate is already bound.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="k">class</span><span class="w"> </span><span class="nc">BindVisitor</span><span class="p">(</span><span class="n">BooleanExpressionVisitor</span><span class="p">[</span><span class="n">BooleanExpression</span><span class="p">]):</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Rewrites a boolean expression by replacing unbound references with references to fields in a struct schema.</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">      schema (Schema): A schema to use when binding the expression.</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">      case_sensitive (bool): Whether to consider case when binding a reference to a field in a schema, defaults to True.</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">        TypeError: In the case a predicate is already bound.</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="n">schema</span><span class="p">:</span> <span class="n">Schema</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">Schema</span><span class="p">,</span> <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">schema</span> <span class="o">=</span> <span class="n">schema</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">case_sensitive</span> <span class="o">=</span> <span class="n">case_sensitive</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_true</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="k">return</span> <span class="n">AlwaysTrue</span><span class="p">()</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_false</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="k">return</span> <span class="n">AlwaysFalse</span><span class="p">()</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_result</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="k">return</span> <span class="n">Not</span><span class="p">(</span><span class="n">child</span><span class="o">=</span><span class="n">child_result</span><span class="p">)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_and</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_result</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">,</span> <span class="n">right_result</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="k">return</span> <span class="n">And</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">left_result</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">right_result</span><span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_or</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_result</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">,</span> <span class="n">right_result</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="k">return</span> <span class="n">Or</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">left_result</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">right_result</span><span class="p">)</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_unbound_predicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">UnboundPredicate</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="k">return</span> <span class="n">predicate</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span> <span class="n">case_sensitive</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">case_sensitive</span><span class="p">)</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_bound_predicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">BoundPredicate</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found already bound predicate: </span><span class="si">{</span><span class="n">predicate</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pyiceberg.expressions.visitors.BooleanExpressionVisitor" class="doc doc-heading">
            <code>BooleanExpressionVisitor</code>


<a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="pyiceberg.expressions.visitors.T">T</span>]</code>, <code><span title="abc.ABC">ABC</span></code></p>







              <details class="quote">
                <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="k">class</span><span class="w"> </span><span class="nc">BooleanExpressionVisitor</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="n">ABC</span><span class="p">):</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_true</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit method for an AlwaysTrue boolean expression.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        Note: This visit method has no arguments since AlwaysTrue instances have no context.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_false</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit method for an AlwaysFalse boolean expression.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        Note: This visit method has no arguments since AlwaysFalse instances have no context.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_result</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit method for a Not boolean expression.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">            child_result (T): The result of visiting the child of the Not boolean expression.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_and</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_result</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">right_result</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit method for an And boolean expression.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">            left_result (T): The result of visiting the left side of the expression.</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">            right_result (T): The result of visiting the right side of the expression.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_or</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_result</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">right_result</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit method for an Or boolean expression.</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">            left_result (T): The result of visiting the left side of the expression.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">            right_result (T): The result of visiting the right side of the expression.</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_unbound_predicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">UnboundPredicate</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit method for an unbound predicate in an expression tree.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            predicate (UnboundPredicate[L): An instance of an UnboundPredicate.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_bound_predicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">BoundPredicate</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit method for a bound predicate in an expression tree.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">            predicate (BoundPredicate[L]): An instance of a BoundPredicate.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_and" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_and</span><span class="p">(</span><span class="n">left_result</span><span class="p">,</span> <span class="n">right_result</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_and" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit method for an And boolean expression.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>left_result</code>
            </td>
            <td>
                  <code><span title="pyiceberg.expressions.visitors.T">T</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The result of visiting the left side of the expression.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>right_result</code>
            </td>
            <td>
                  <code><span title="pyiceberg.expressions.visitors.T">T</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The result of visiting the right side of the expression.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_and</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_result</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">right_result</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit method for an And boolean expression.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        left_result (T): The result of visiting the left side of the expression.</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        right_result (T): The result of visiting the right side of the expression.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_bound_predicate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_bound_predicate</span><span class="p">(</span><span class="n">predicate</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_bound_predicate" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit method for a bound predicate in an expression tree.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>predicate</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="pyiceberg.expressions.BoundPredicate" href="../#pyiceberg.expressions.BoundPredicate">BoundPredicate</a>[<span title="pyiceberg.typedef.L">L</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An instance of a BoundPredicate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_bound_predicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">BoundPredicate</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit method for a bound predicate in an expression tree.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        predicate (BoundPredicate[L]): An instance of a BoundPredicate.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_false" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_false</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_false" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit method for an AlwaysFalse boolean expression.</p>
<p>Note: This visit method has no arguments since AlwaysFalse instances have no context.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_false</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit method for an AlwaysFalse boolean expression.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    Note: This visit method has no arguments since AlwaysFalse instances have no context.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_not" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_not</span><span class="p">(</span><span class="n">child_result</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_not" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit method for a Not boolean expression.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>child_result</code>
            </td>
            <td>
                  <code><span title="pyiceberg.expressions.visitors.T">T</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The result of visiting the child of the Not boolean expression.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_not</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_result</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit method for a Not boolean expression.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        child_result (T): The result of visiting the child of the Not boolean expression.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_or" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_or</span><span class="p">(</span><span class="n">left_result</span><span class="p">,</span> <span class="n">right_result</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_or" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit method for an Or boolean expression.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>left_result</code>
            </td>
            <td>
                  <code><span title="pyiceberg.expressions.visitors.T">T</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The result of visiting the left side of the expression.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>right_result</code>
            </td>
            <td>
                  <code><span title="pyiceberg.expressions.visitors.T">T</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The result of visiting the right side of the expression.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_or</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_result</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">right_result</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit method for an Or boolean expression.</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        left_result (T): The result of visiting the left side of the expression.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        right_result (T): The result of visiting the right side of the expression.</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_true" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_true</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_true" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit method for an AlwaysTrue boolean expression.</p>
<p>Note: This visit method has no arguments since AlwaysTrue instances have no context.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_true</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit method for an AlwaysTrue boolean expression.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    Note: This visit method has no arguments since AlwaysTrue instances have no context.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_unbound_predicate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_unbound_predicate</span><span class="p">(</span><span class="n">predicate</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor.visit_unbound_predicate" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit method for an unbound predicate in an expression tree.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>predicate</code>
            </td>
            <td>
                  <code>UnboundPredicate[L</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An instance of an UnboundPredicate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_unbound_predicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">UnboundPredicate</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit method for an unbound predicate in an expression tree.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        predicate (UnboundPredicate[L): An instance of an UnboundPredicate.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor" class="doc doc-heading">
            <code>BoundBooleanExpressionVisitor</code>


<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="pyiceberg.expressions.visitors.BooleanExpressionVisitor" href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor">BooleanExpressionVisitor</a>[<span title="pyiceberg.expressions.visitors.T">T</span>]</code>, <code><span title="abc.ABC">ABC</span></code></p>







              <details class="quote">
                <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="k">class</span><span class="w"> </span><span class="nc">BoundBooleanExpressionVisitor</span><span class="p">(</span><span class="n">BooleanExpressionVisitor</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="n">ABC</span><span class="p">):</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literals</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit a bound In predicate.&quot;&quot;&quot;</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literals</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit a bound NotIn predicate.&quot;&quot;&quot;</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_is_nan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit a bound IsNan predicate.&quot;&quot;&quot;</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not_nan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit a bound NotNan predicate.&quot;&quot;&quot;</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_is_null</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit a bound IsNull predicate.&quot;&quot;&quot;</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not_null</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit a bound NotNull predicate.&quot;&quot;&quot;</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit a bound Equal predicate.&quot;&quot;&quot;</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit a bound NotEqual predicate.&quot;&quot;&quot;</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_greater_than_or_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit a bound GreaterThanOrEqual predicate.&quot;&quot;&quot;</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_greater_than</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit a bound GreaterThan predicate.&quot;&quot;&quot;</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_less_than</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit a bound LessThan predicate.&quot;&quot;&quot;</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_less_than_or_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit a bound LessThanOrEqual predicate.&quot;&quot;&quot;</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_true</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit a bound True predicate.&quot;&quot;&quot;</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_false</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit a bound False predicate.&quot;&quot;&quot;</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_result</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit a bound Not predicate.&quot;&quot;&quot;</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_and</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_result</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">right_result</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit a bound And predicate.&quot;&quot;&quot;</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_or</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_result</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">right_result</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit a bound Or predicate.&quot;&quot;&quot;</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_starts_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit bound StartsWith predicate.&quot;&quot;&quot;</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not_starts_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit bound NotStartsWith predicate.&quot;&quot;&quot;</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_unbound_predicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">UnboundPredicate</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit an unbound predicate.</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">            predicate (UnboundPredicate[L]): An unbound predicate.</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">            TypeError: This always raises since an unbound predicate is not expected in a bound boolean expression.</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Not a bound predicate: </span><span class="si">{</span><span class="n">predicate</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_bound_predicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">BoundPredicate</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit a bound predicate.</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">            predicate (BoundPredicate[L]): A bound predicate.</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>        <span class="k">return</span> <span class="n">visit_bound_predicate</span><span class="p">(</span><span class="n">predicate</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_and" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_and</span><span class="p">(</span><span class="n">left_result</span><span class="p">,</span> <span class="n">right_result</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_and" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit a bound And predicate.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_and</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_result</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">right_result</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit a bound And predicate.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_bound_predicate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_bound_predicate</span><span class="p">(</span><span class="n">predicate</span><span class="p">)</span></code>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_bound_predicate" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit a bound predicate.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>predicate</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="pyiceberg.expressions.BoundPredicate" href="../#pyiceberg.expressions.BoundPredicate">BoundPredicate</a>[<span title="pyiceberg.typedef.L">L</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A bound predicate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_bound_predicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">BoundPredicate</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit a bound predicate.</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">        predicate (BoundPredicate[L]): A bound predicate.</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="k">return</span> <span class="n">visit_bound_predicate</span><span class="p">(</span><span class="n">predicate</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_equal" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_equal</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">literal</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_equal" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit a bound Equal predicate.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit a bound Equal predicate.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_false" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_false</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_false" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit a bound False predicate.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_false</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit a bound False predicate.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_greater_than" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_greater_than</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">literal</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_greater_than" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit a bound GreaterThan predicate.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_greater_than</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit a bound GreaterThan predicate.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_greater_than_or_equal" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_greater_than_or_equal</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">literal</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_greater_than_or_equal" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit a bound GreaterThanOrEqual predicate.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_greater_than_or_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit a bound GreaterThanOrEqual predicate.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_in" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_in</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">literals</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_in" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit a bound In predicate.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literals</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit a bound In predicate.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_is_nan" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_is_nan</span><span class="p">(</span><span class="n">term</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_is_nan" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit a bound IsNan predicate.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_is_nan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit a bound IsNan predicate.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_is_null" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_is_null</span><span class="p">(</span><span class="n">term</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_is_null" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit a bound IsNull predicate.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_is_null</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit a bound IsNull predicate.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_less_than" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_less_than</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">literal</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_less_than" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit a bound LessThan predicate.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_less_than</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit a bound LessThan predicate.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_less_than_or_equal" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_less_than_or_equal</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">literal</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_less_than_or_equal" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit a bound LessThanOrEqual predicate.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_less_than_or_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit a bound LessThanOrEqual predicate.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_not</span><span class="p">(</span><span class="n">child_result</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit a bound Not predicate.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_not</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_result</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit a bound Not predicate.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not_equal" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_not_equal</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">literal</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not_equal" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit a bound NotEqual predicate.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_not_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit a bound NotEqual predicate.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not_in" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_not_in</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">literals</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not_in" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit a bound NotIn predicate.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_not_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literals</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit a bound NotIn predicate.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not_nan" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_not_nan</span><span class="p">(</span><span class="n">term</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not_nan" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit a bound NotNan predicate.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_not_nan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit a bound NotNan predicate.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not_null" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_not_null</span><span class="p">(</span><span class="n">term</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not_null" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit a bound NotNull predicate.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_not_null</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit a bound NotNull predicate.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not_starts_with" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_not_starts_with</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">literal</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_not_starts_with" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit bound NotStartsWith predicate.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_not_starts_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit bound NotStartsWith predicate.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_or" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_or</span><span class="p">(</span><span class="n">left_result</span><span class="p">,</span> <span class="n">right_result</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_or" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit a bound Or predicate.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_or</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_result</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">right_result</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit a bound Or predicate.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_starts_with" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_starts_with</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">literal</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_starts_with" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit bound StartsWith predicate.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_starts_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit bound StartsWith predicate.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_true" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_true</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_true" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit a bound True predicate.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_true</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit a bound True predicate.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_unbound_predicate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_unbound_predicate</span><span class="p">(</span><span class="n">predicate</span><span class="p">)</span></code>

<a href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor.visit_unbound_predicate" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Visit an unbound predicate.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>predicate</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="pyiceberg.expressions.UnboundPredicate" href="../#pyiceberg.expressions.UnboundPredicate">UnboundPredicate</a>[<span title="pyiceberg.typedef.L">L</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An unbound predicate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Raises:
    TypeError: This always raises since an unbound predicate is not expected in a bound boolean expression.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_unbound_predicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">UnboundPredicate</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Visit an unbound predicate.</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        predicate (UnboundPredicate[L]): An unbound predicate.</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">        TypeError: This always raises since an unbound predicate is not expected in a bound boolean expression.</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Not a bound predicate: </span><span class="si">{</span><span class="n">predicate</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pyiceberg.expressions.visitors.ResidualVisitor" class="doc doc-heading">
            <code>ResidualVisitor</code>


<a href="#pyiceberg.expressions.visitors.ResidualVisitor" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor" href="#pyiceberg.expressions.visitors.BoundBooleanExpressionVisitor">BoundBooleanExpressionVisitor</a>[<a class="autorefs autorefs-internal" title="pyiceberg.expressions.BooleanExpression" href="../#pyiceberg.expressions.BooleanExpression">BooleanExpression</a>]</code>, <code><span title="abc.ABC">ABC</span></code></p>


        <p>Finds the residuals for an Expression the partitions in the given PartitionSpec.</p>
<p>A residual expression is made by partially evaluating an expression using partition values.
For example, if a table is partitioned by day(utc_timestamp) and is read with a filter expression
utc_timestamp &gt; a and utc_timestamp &lt; b, then there are 4 possible residuals expressions
for the partition data, d:</p>
<ol>
<li>If d &gt; day(a) and d &lt; day(b), the residual is always true</li>
<li>If d == day(a) and d != day(b), the residual is utc_timestamp &gt; a</li>
<li>if d == day(b) and d != day(a), the residual is utc_timestamp &lt; b</li>
<li>If d == day(a) == day(b), the residual is utc_timestamp &gt; a and utc_timestamp &lt; b
Partition data is passed using StructLike. Residuals are returned by residualFor(StructLike).</li>
</ol>






              <details class="quote">
                <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1737">1737</a></span>
<span class="normal"><a href="#__codelineno-0-1738">1738</a></span>
<span class="normal"><a href="#__codelineno-0-1739">1739</a></span>
<span class="normal"><a href="#__codelineno-0-1740">1740</a></span>
<span class="normal"><a href="#__codelineno-0-1741">1741</a></span>
<span class="normal"><a href="#__codelineno-0-1742">1742</a></span>
<span class="normal"><a href="#__codelineno-0-1743">1743</a></span>
<span class="normal"><a href="#__codelineno-0-1744">1744</a></span>
<span class="normal"><a href="#__codelineno-0-1745">1745</a></span>
<span class="normal"><a href="#__codelineno-0-1746">1746</a></span>
<span class="normal"><a href="#__codelineno-0-1747">1747</a></span>
<span class="normal"><a href="#__codelineno-0-1748">1748</a></span>
<span class="normal"><a href="#__codelineno-0-1749">1749</a></span>
<span class="normal"><a href="#__codelineno-0-1750">1750</a></span>
<span class="normal"><a href="#__codelineno-0-1751">1751</a></span>
<span class="normal"><a href="#__codelineno-0-1752">1752</a></span>
<span class="normal"><a href="#__codelineno-0-1753">1753</a></span>
<span class="normal"><a href="#__codelineno-0-1754">1754</a></span>
<span class="normal"><a href="#__codelineno-0-1755">1755</a></span>
<span class="normal"><a href="#__codelineno-0-1756">1756</a></span>
<span class="normal"><a href="#__codelineno-0-1757">1757</a></span>
<span class="normal"><a href="#__codelineno-0-1758">1758</a></span>
<span class="normal"><a href="#__codelineno-0-1759">1759</a></span>
<span class="normal"><a href="#__codelineno-0-1760">1760</a></span>
<span class="normal"><a href="#__codelineno-0-1761">1761</a></span>
<span class="normal"><a href="#__codelineno-0-1762">1762</a></span>
<span class="normal"><a href="#__codelineno-0-1763">1763</a></span>
<span class="normal"><a href="#__codelineno-0-1764">1764</a></span>
<span class="normal"><a href="#__codelineno-0-1765">1765</a></span>
<span class="normal"><a href="#__codelineno-0-1766">1766</a></span>
<span class="normal"><a href="#__codelineno-0-1767">1767</a></span>
<span class="normal"><a href="#__codelineno-0-1768">1768</a></span>
<span class="normal"><a href="#__codelineno-0-1769">1769</a></span>
<span class="normal"><a href="#__codelineno-0-1770">1770</a></span>
<span class="normal"><a href="#__codelineno-0-1771">1771</a></span>
<span class="normal"><a href="#__codelineno-0-1772">1772</a></span>
<span class="normal"><a href="#__codelineno-0-1773">1773</a></span>
<span class="normal"><a href="#__codelineno-0-1774">1774</a></span>
<span class="normal"><a href="#__codelineno-0-1775">1775</a></span>
<span class="normal"><a href="#__codelineno-0-1776">1776</a></span>
<span class="normal"><a href="#__codelineno-0-1777">1777</a></span>
<span class="normal"><a href="#__codelineno-0-1778">1778</a></span>
<span class="normal"><a href="#__codelineno-0-1779">1779</a></span>
<span class="normal"><a href="#__codelineno-0-1780">1780</a></span>
<span class="normal"><a href="#__codelineno-0-1781">1781</a></span>
<span class="normal"><a href="#__codelineno-0-1782">1782</a></span>
<span class="normal"><a href="#__codelineno-0-1783">1783</a></span>
<span class="normal"><a href="#__codelineno-0-1784">1784</a></span>
<span class="normal"><a href="#__codelineno-0-1785">1785</a></span>
<span class="normal"><a href="#__codelineno-0-1786">1786</a></span>
<span class="normal"><a href="#__codelineno-0-1787">1787</a></span>
<span class="normal"><a href="#__codelineno-0-1788">1788</a></span>
<span class="normal"><a href="#__codelineno-0-1789">1789</a></span>
<span class="normal"><a href="#__codelineno-0-1790">1790</a></span>
<span class="normal"><a href="#__codelineno-0-1791">1791</a></span>
<span class="normal"><a href="#__codelineno-0-1792">1792</a></span>
<span class="normal"><a href="#__codelineno-0-1793">1793</a></span>
<span class="normal"><a href="#__codelineno-0-1794">1794</a></span>
<span class="normal"><a href="#__codelineno-0-1795">1795</a></span>
<span class="normal"><a href="#__codelineno-0-1796">1796</a></span>
<span class="normal"><a href="#__codelineno-0-1797">1797</a></span>
<span class="normal"><a href="#__codelineno-0-1798">1798</a></span>
<span class="normal"><a href="#__codelineno-0-1799">1799</a></span>
<span class="normal"><a href="#__codelineno-0-1800">1800</a></span>
<span class="normal"><a href="#__codelineno-0-1801">1801</a></span>
<span class="normal"><a href="#__codelineno-0-1802">1802</a></span>
<span class="normal"><a href="#__codelineno-0-1803">1803</a></span>
<span class="normal"><a href="#__codelineno-0-1804">1804</a></span>
<span class="normal"><a href="#__codelineno-0-1805">1805</a></span>
<span class="normal"><a href="#__codelineno-0-1806">1806</a></span>
<span class="normal"><a href="#__codelineno-0-1807">1807</a></span>
<span class="normal"><a href="#__codelineno-0-1808">1808</a></span>
<span class="normal"><a href="#__codelineno-0-1809">1809</a></span>
<span class="normal"><a href="#__codelineno-0-1810">1810</a></span>
<span class="normal"><a href="#__codelineno-0-1811">1811</a></span>
<span class="normal"><a href="#__codelineno-0-1812">1812</a></span>
<span class="normal"><a href="#__codelineno-0-1813">1813</a></span>
<span class="normal"><a href="#__codelineno-0-1814">1814</a></span>
<span class="normal"><a href="#__codelineno-0-1815">1815</a></span>
<span class="normal"><a href="#__codelineno-0-1816">1816</a></span>
<span class="normal"><a href="#__codelineno-0-1817">1817</a></span>
<span class="normal"><a href="#__codelineno-0-1818">1818</a></span>
<span class="normal"><a href="#__codelineno-0-1819">1819</a></span>
<span class="normal"><a href="#__codelineno-0-1820">1820</a></span>
<span class="normal"><a href="#__codelineno-0-1821">1821</a></span>
<span class="normal"><a href="#__codelineno-0-1822">1822</a></span>
<span class="normal"><a href="#__codelineno-0-1823">1823</a></span>
<span class="normal"><a href="#__codelineno-0-1824">1824</a></span>
<span class="normal"><a href="#__codelineno-0-1825">1825</a></span>
<span class="normal"><a href="#__codelineno-0-1826">1826</a></span>
<span class="normal"><a href="#__codelineno-0-1827">1827</a></span>
<span class="normal"><a href="#__codelineno-0-1828">1828</a></span>
<span class="normal"><a href="#__codelineno-0-1829">1829</a></span>
<span class="normal"><a href="#__codelineno-0-1830">1830</a></span>
<span class="normal"><a href="#__codelineno-0-1831">1831</a></span>
<span class="normal"><a href="#__codelineno-0-1832">1832</a></span>
<span class="normal"><a href="#__codelineno-0-1833">1833</a></span>
<span class="normal"><a href="#__codelineno-0-1834">1834</a></span>
<span class="normal"><a href="#__codelineno-0-1835">1835</a></span>
<span class="normal"><a href="#__codelineno-0-1836">1836</a></span>
<span class="normal"><a href="#__codelineno-0-1837">1837</a></span>
<span class="normal"><a href="#__codelineno-0-1838">1838</a></span>
<span class="normal"><a href="#__codelineno-0-1839">1839</a></span>
<span class="normal"><a href="#__codelineno-0-1840">1840</a></span>
<span class="normal"><a href="#__codelineno-0-1841">1841</a></span>
<span class="normal"><a href="#__codelineno-0-1842">1842</a></span>
<span class="normal"><a href="#__codelineno-0-1843">1843</a></span>
<span class="normal"><a href="#__codelineno-0-1844">1844</a></span>
<span class="normal"><a href="#__codelineno-0-1845">1845</a></span>
<span class="normal"><a href="#__codelineno-0-1846">1846</a></span>
<span class="normal"><a href="#__codelineno-0-1847">1847</a></span>
<span class="normal"><a href="#__codelineno-0-1848">1848</a></span>
<span class="normal"><a href="#__codelineno-0-1849">1849</a></span>
<span class="normal"><a href="#__codelineno-0-1850">1850</a></span>
<span class="normal"><a href="#__codelineno-0-1851">1851</a></span>
<span class="normal"><a href="#__codelineno-0-1852">1852</a></span>
<span class="normal"><a href="#__codelineno-0-1853">1853</a></span>
<span class="normal"><a href="#__codelineno-0-1854">1854</a></span>
<span class="normal"><a href="#__codelineno-0-1855">1855</a></span>
<span class="normal"><a href="#__codelineno-0-1856">1856</a></span>
<span class="normal"><a href="#__codelineno-0-1857">1857</a></span>
<span class="normal"><a href="#__codelineno-0-1858">1858</a></span>
<span class="normal"><a href="#__codelineno-0-1859">1859</a></span>
<span class="normal"><a href="#__codelineno-0-1860">1860</a></span>
<span class="normal"><a href="#__codelineno-0-1861">1861</a></span>
<span class="normal"><a href="#__codelineno-0-1862">1862</a></span>
<span class="normal"><a href="#__codelineno-0-1863">1863</a></span>
<span class="normal"><a href="#__codelineno-0-1864">1864</a></span>
<span class="normal"><a href="#__codelineno-0-1865">1865</a></span>
<span class="normal"><a href="#__codelineno-0-1866">1866</a></span>
<span class="normal"><a href="#__codelineno-0-1867">1867</a></span>
<span class="normal"><a href="#__codelineno-0-1868">1868</a></span>
<span class="normal"><a href="#__codelineno-0-1869">1869</a></span>
<span class="normal"><a href="#__codelineno-0-1870">1870</a></span>
<span class="normal"><a href="#__codelineno-0-1871">1871</a></span>
<span class="normal"><a href="#__codelineno-0-1872">1872</a></span>
<span class="normal"><a href="#__codelineno-0-1873">1873</a></span>
<span class="normal"><a href="#__codelineno-0-1874">1874</a></span>
<span class="normal"><a href="#__codelineno-0-1875">1875</a></span>
<span class="normal"><a href="#__codelineno-0-1876">1876</a></span>
<span class="normal"><a href="#__codelineno-0-1877">1877</a></span>
<span class="normal"><a href="#__codelineno-0-1878">1878</a></span>
<span class="normal"><a href="#__codelineno-0-1879">1879</a></span>
<span class="normal"><a href="#__codelineno-0-1880">1880</a></span>
<span class="normal"><a href="#__codelineno-0-1881">1881</a></span>
<span class="normal"><a href="#__codelineno-0-1882">1882</a></span>
<span class="normal"><a href="#__codelineno-0-1883">1883</a></span>
<span class="normal"><a href="#__codelineno-0-1884">1884</a></span>
<span class="normal"><a href="#__codelineno-0-1885">1885</a></span>
<span class="normal"><a href="#__codelineno-0-1886">1886</a></span>
<span class="normal"><a href="#__codelineno-0-1887">1887</a></span>
<span class="normal"><a href="#__codelineno-0-1888">1888</a></span>
<span class="normal"><a href="#__codelineno-0-1889">1889</a></span>
<span class="normal"><a href="#__codelineno-0-1890">1890</a></span>
<span class="normal"><a href="#__codelineno-0-1891">1891</a></span>
<span class="normal"><a href="#__codelineno-0-1892">1892</a></span>
<span class="normal"><a href="#__codelineno-0-1893">1893</a></span>
<span class="normal"><a href="#__codelineno-0-1894">1894</a></span>
<span class="normal"><a href="#__codelineno-0-1895">1895</a></span>
<span class="normal"><a href="#__codelineno-0-1896">1896</a></span>
<span class="normal"><a href="#__codelineno-0-1897">1897</a></span>
<span class="normal"><a href="#__codelineno-0-1898">1898</a></span>
<span class="normal"><a href="#__codelineno-0-1899">1899</a></span>
<span class="normal"><a href="#__codelineno-0-1900">1900</a></span>
<span class="normal"><a href="#__codelineno-0-1901">1901</a></span>
<span class="normal"><a href="#__codelineno-0-1902">1902</a></span>
<span class="normal"><a href="#__codelineno-0-1903">1903</a></span>
<span class="normal"><a href="#__codelineno-0-1904">1904</a></span>
<span class="normal"><a href="#__codelineno-0-1905">1905</a></span>
<span class="normal"><a href="#__codelineno-0-1906">1906</a></span>
<span class="normal"><a href="#__codelineno-0-1907">1907</a></span>
<span class="normal"><a href="#__codelineno-0-1908">1908</a></span>
<span class="normal"><a href="#__codelineno-0-1909">1909</a></span>
<span class="normal"><a href="#__codelineno-0-1910">1910</a></span>
<span class="normal"><a href="#__codelineno-0-1911">1911</a></span>
<span class="normal"><a href="#__codelineno-0-1912">1912</a></span>
<span class="normal"><a href="#__codelineno-0-1913">1913</a></span>
<span class="normal"><a href="#__codelineno-0-1914">1914</a></span>
<span class="normal"><a href="#__codelineno-0-1915">1915</a></span>
<span class="normal"><a href="#__codelineno-0-1916">1916</a></span>
<span class="normal"><a href="#__codelineno-0-1917">1917</a></span>
<span class="normal"><a href="#__codelineno-0-1918">1918</a></span>
<span class="normal"><a href="#__codelineno-0-1919">1919</a></span>
<span class="normal"><a href="#__codelineno-0-1920">1920</a></span>
<span class="normal"><a href="#__codelineno-0-1921">1921</a></span>
<span class="normal"><a href="#__codelineno-0-1922">1922</a></span>
<span class="normal"><a href="#__codelineno-0-1923">1923</a></span>
<span class="normal"><a href="#__codelineno-0-1924">1924</a></span>
<span class="normal"><a href="#__codelineno-0-1925">1925</a></span>
<span class="normal"><a href="#__codelineno-0-1926">1926</a></span>
<span class="normal"><a href="#__codelineno-0-1927">1927</a></span>
<span class="normal"><a href="#__codelineno-0-1928">1928</a></span>
<span class="normal"><a href="#__codelineno-0-1929">1929</a></span>
<span class="normal"><a href="#__codelineno-0-1930">1930</a></span>
<span class="normal"><a href="#__codelineno-0-1931">1931</a></span>
<span class="normal"><a href="#__codelineno-0-1932">1932</a></span>
<span class="normal"><a href="#__codelineno-0-1933">1933</a></span>
<span class="normal"><a href="#__codelineno-0-1934">1934</a></span>
<span class="normal"><a href="#__codelineno-0-1935">1935</a></span>
<span class="normal"><a href="#__codelineno-0-1936">1936</a></span>
<span class="normal"><a href="#__codelineno-0-1937">1937</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1737" name="__codelineno-0-1737"></a><span class="k">class</span><span class="w"> </span><span class="nc">ResidualVisitor</span><span class="p">(</span><span class="n">BoundBooleanExpressionVisitor</span><span class="p">[</span><span class="n">BooleanExpression</span><span class="p">],</span> <span class="n">ABC</span><span class="p">):</span>
<a id="__codelineno-0-1738" name="__codelineno-0-1738"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Finds the residuals for an Expression the partitions in the given PartitionSpec.</span>
<a id="__codelineno-0-1739" name="__codelineno-0-1739"></a>
<a id="__codelineno-0-1740" name="__codelineno-0-1740"></a><span class="sd">    A residual expression is made by partially evaluating an expression using partition values.</span>
<a id="__codelineno-0-1741" name="__codelineno-0-1741"></a><span class="sd">    For example, if a table is partitioned by day(utc_timestamp) and is read with a filter expression</span>
<a id="__codelineno-0-1742" name="__codelineno-0-1742"></a><span class="sd">    utc_timestamp &gt; a and utc_timestamp &lt; b, then there are 4 possible residuals expressions</span>
<a id="__codelineno-0-1743" name="__codelineno-0-1743"></a><span class="sd">    for the partition data, d:</span>
<a id="__codelineno-0-1744" name="__codelineno-0-1744"></a>
<a id="__codelineno-0-1745" name="__codelineno-0-1745"></a>
<a id="__codelineno-0-1746" name="__codelineno-0-1746"></a><span class="sd">    1. If d &gt; day(a) and d &amp;lt; day(b), the residual is always true</span>
<a id="__codelineno-0-1747" name="__codelineno-0-1747"></a><span class="sd">    2. If d == day(a) and d != day(b), the residual is utc_timestamp &gt; a</span>
<a id="__codelineno-0-1748" name="__codelineno-0-1748"></a><span class="sd">    3. if d == day(b) and d != day(a), the residual is utc_timestamp &lt; b</span>
<a id="__codelineno-0-1749" name="__codelineno-0-1749"></a><span class="sd">    4. If d == day(a) == day(b), the residual is utc_timestamp &gt; a and utc_timestamp &lt; b</span>
<a id="__codelineno-0-1750" name="__codelineno-0-1750"></a><span class="sd">    Partition data is passed using StructLike. Residuals are returned by residualFor(StructLike).</span>
<a id="__codelineno-0-1751" name="__codelineno-0-1751"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1752" name="__codelineno-0-1752"></a>
<a id="__codelineno-0-1753" name="__codelineno-0-1753"></a>    <span class="n">schema</span><span class="p">:</span> <span class="n">Schema</span>
<a id="__codelineno-0-1754" name="__codelineno-0-1754"></a>    <span class="n">spec</span><span class="p">:</span> <span class="n">PartitionSpec</span>
<a id="__codelineno-0-1755" name="__codelineno-0-1755"></a>    <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span>
<a id="__codelineno-0-1756" name="__codelineno-0-1756"></a>    <span class="n">expr</span><span class="p">:</span> <span class="n">BooleanExpression</span>
<a id="__codelineno-0-1757" name="__codelineno-0-1757"></a>
<a id="__codelineno-0-1758" name="__codelineno-0-1758"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">Schema</span><span class="p">,</span> <span class="n">spec</span><span class="p">:</span> <span class="n">PartitionSpec</span><span class="p">,</span> <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">expr</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1759" name="__codelineno-0-1759"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">schema</span> <span class="o">=</span> <span class="n">schema</span>
<a id="__codelineno-0-1760" name="__codelineno-0-1760"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">spec</span> <span class="o">=</span> <span class="n">spec</span>
<a id="__codelineno-0-1761" name="__codelineno-0-1761"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">case_sensitive</span> <span class="o">=</span> <span class="n">case_sensitive</span>
<a id="__codelineno-0-1762" name="__codelineno-0-1762"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">expr</span> <span class="o">=</span> <span class="n">expr</span>
<a id="__codelineno-0-1763" name="__codelineno-0-1763"></a>
<a id="__codelineno-0-1764" name="__codelineno-0-1764"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">partition_data</span><span class="p">:</span> <span class="n">Record</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1765" name="__codelineno-0-1765"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">struct</span> <span class="o">=</span> <span class="n">partition_data</span>
<a id="__codelineno-0-1766" name="__codelineno-0-1766"></a>        <span class="k">return</span> <span class="n">visit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expr</span><span class="p">,</span> <span class="n">visitor</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-1767" name="__codelineno-0-1767"></a>
<a id="__codelineno-0-1768" name="__codelineno-0-1768"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_true</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1769" name="__codelineno-0-1769"></a>        <span class="k">return</span> <span class="n">AlwaysTrue</span><span class="p">()</span>
<a id="__codelineno-0-1770" name="__codelineno-0-1770"></a>
<a id="__codelineno-0-1771" name="__codelineno-0-1771"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_false</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1772" name="__codelineno-0-1772"></a>        <span class="k">return</span> <span class="n">AlwaysFalse</span><span class="p">()</span>
<a id="__codelineno-0-1773" name="__codelineno-0-1773"></a>
<a id="__codelineno-0-1774" name="__codelineno-0-1774"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_result</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1775" name="__codelineno-0-1775"></a>        <span class="k">return</span> <span class="n">Not</span><span class="p">(</span><span class="n">child_result</span><span class="p">)</span>
<a id="__codelineno-0-1776" name="__codelineno-0-1776"></a>
<a id="__codelineno-0-1777" name="__codelineno-0-1777"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_and</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_result</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">,</span> <span class="n">right_result</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1778" name="__codelineno-0-1778"></a>        <span class="k">return</span> <span class="n">And</span><span class="p">(</span><span class="n">left_result</span><span class="p">,</span> <span class="n">right_result</span><span class="p">)</span>
<a id="__codelineno-0-1779" name="__codelineno-0-1779"></a>
<a id="__codelineno-0-1780" name="__codelineno-0-1780"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_or</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_result</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">,</span> <span class="n">right_result</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1781" name="__codelineno-0-1781"></a>        <span class="k">return</span> <span class="n">Or</span><span class="p">(</span><span class="n">left_result</span><span class="p">,</span> <span class="n">right_result</span><span class="p">)</span>
<a id="__codelineno-0-1782" name="__codelineno-0-1782"></a>
<a id="__codelineno-0-1783" name="__codelineno-0-1783"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_is_null</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1784" name="__codelineno-0-1784"></a>        <span class="k">if</span> <span class="n">term</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">struct</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1785" name="__codelineno-0-1785"></a>            <span class="k">return</span> <span class="n">AlwaysTrue</span><span class="p">()</span>
<a id="__codelineno-0-1786" name="__codelineno-0-1786"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1787" name="__codelineno-0-1787"></a>            <span class="k">return</span> <span class="n">AlwaysFalse</span><span class="p">()</span>
<a id="__codelineno-0-1788" name="__codelineno-0-1788"></a>
<a id="__codelineno-0-1789" name="__codelineno-0-1789"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not_null</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1790" name="__codelineno-0-1790"></a>        <span class="k">if</span> <span class="n">term</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">struct</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1791" name="__codelineno-0-1791"></a>            <span class="k">return</span> <span class="n">AlwaysTrue</span><span class="p">()</span>
<a id="__codelineno-0-1792" name="__codelineno-0-1792"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1793" name="__codelineno-0-1793"></a>            <span class="k">return</span> <span class="n">AlwaysFalse</span><span class="p">()</span>
<a id="__codelineno-0-1794" name="__codelineno-0-1794"></a>
<a id="__codelineno-0-1795" name="__codelineno-0-1795"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_is_nan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1796" name="__codelineno-0-1796"></a>        <span class="n">val</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">struct</span><span class="p">)</span>
<a id="__codelineno-0-1797" name="__codelineno-0-1797"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">SupportsFloat</span><span class="p">)</span> <span class="ow">and</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
<a id="__codelineno-0-1798" name="__codelineno-0-1798"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_true</span><span class="p">()</span>
<a id="__codelineno-0-1799" name="__codelineno-0-1799"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1800" name="__codelineno-0-1800"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_false</span><span class="p">()</span>
<a id="__codelineno-0-1801" name="__codelineno-0-1801"></a>
<a id="__codelineno-0-1802" name="__codelineno-0-1802"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not_nan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1803" name="__codelineno-0-1803"></a>        <span class="n">val</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">struct</span><span class="p">)</span>
<a id="__codelineno-0-1804" name="__codelineno-0-1804"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">SupportsFloat</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
<a id="__codelineno-0-1805" name="__codelineno-0-1805"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_true</span><span class="p">()</span>
<a id="__codelineno-0-1806" name="__codelineno-0-1806"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1807" name="__codelineno-0-1807"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_false</span><span class="p">()</span>
<a id="__codelineno-0-1808" name="__codelineno-0-1808"></a>
<a id="__codelineno-0-1809" name="__codelineno-0-1809"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_less_than</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1810" name="__codelineno-0-1810"></a>        <span class="k">if</span> <span class="n">term</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">struct</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1811" name="__codelineno-0-1811"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_true</span><span class="p">()</span>
<a id="__codelineno-0-1812" name="__codelineno-0-1812"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1813" name="__codelineno-0-1813"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_false</span><span class="p">()</span>
<a id="__codelineno-0-1814" name="__codelineno-0-1814"></a>
<a id="__codelineno-0-1815" name="__codelineno-0-1815"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_less_than_or_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1816" name="__codelineno-0-1816"></a>        <span class="k">if</span> <span class="n">term</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">struct</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1817" name="__codelineno-0-1817"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_true</span><span class="p">()</span>
<a id="__codelineno-0-1818" name="__codelineno-0-1818"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1819" name="__codelineno-0-1819"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_false</span><span class="p">()</span>
<a id="__codelineno-0-1820" name="__codelineno-0-1820"></a>
<a id="__codelineno-0-1821" name="__codelineno-0-1821"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_greater_than</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1822" name="__codelineno-0-1822"></a>        <span class="k">if</span> <span class="n">term</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">struct</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1823" name="__codelineno-0-1823"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_true</span><span class="p">()</span>
<a id="__codelineno-0-1824" name="__codelineno-0-1824"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1825" name="__codelineno-0-1825"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_false</span><span class="p">()</span>
<a id="__codelineno-0-1826" name="__codelineno-0-1826"></a>
<a id="__codelineno-0-1827" name="__codelineno-0-1827"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_greater_than_or_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1828" name="__codelineno-0-1828"></a>        <span class="k">if</span> <span class="n">term</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">struct</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1829" name="__codelineno-0-1829"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_true</span><span class="p">()</span>
<a id="__codelineno-0-1830" name="__codelineno-0-1830"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1831" name="__codelineno-0-1831"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_false</span><span class="p">()</span>
<a id="__codelineno-0-1832" name="__codelineno-0-1832"></a>
<a id="__codelineno-0-1833" name="__codelineno-0-1833"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1834" name="__codelineno-0-1834"></a>        <span class="k">if</span> <span class="n">term</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">struct</span><span class="p">)</span> <span class="o">==</span> <span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1835" name="__codelineno-0-1835"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_true</span><span class="p">()</span>
<a id="__codelineno-0-1836" name="__codelineno-0-1836"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1837" name="__codelineno-0-1837"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_false</span><span class="p">()</span>
<a id="__codelineno-0-1838" name="__codelineno-0-1838"></a>
<a id="__codelineno-0-1839" name="__codelineno-0-1839"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1840" name="__codelineno-0-1840"></a>        <span class="k">if</span> <span class="n">term</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">struct</span><span class="p">)</span> <span class="o">!=</span> <span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1841" name="__codelineno-0-1841"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_true</span><span class="p">()</span>
<a id="__codelineno-0-1842" name="__codelineno-0-1842"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1843" name="__codelineno-0-1843"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_false</span><span class="p">()</span>
<a id="__codelineno-0-1844" name="__codelineno-0-1844"></a>
<a id="__codelineno-0-1845" name="__codelineno-0-1845"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literals</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1846" name="__codelineno-0-1846"></a>        <span class="k">if</span> <span class="n">term</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">struct</span><span class="p">)</span> <span class="ow">in</span> <span class="n">literals</span><span class="p">:</span>
<a id="__codelineno-0-1847" name="__codelineno-0-1847"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_true</span><span class="p">()</span>
<a id="__codelineno-0-1848" name="__codelineno-0-1848"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1849" name="__codelineno-0-1849"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_false</span><span class="p">()</span>
<a id="__codelineno-0-1850" name="__codelineno-0-1850"></a>
<a id="__codelineno-0-1851" name="__codelineno-0-1851"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literals</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1852" name="__codelineno-0-1852"></a>        <span class="k">if</span> <span class="n">term</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">struct</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">literals</span><span class="p">:</span>
<a id="__codelineno-0-1853" name="__codelineno-0-1853"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_true</span><span class="p">()</span>
<a id="__codelineno-0-1854" name="__codelineno-0-1854"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1855" name="__codelineno-0-1855"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_false</span><span class="p">()</span>
<a id="__codelineno-0-1856" name="__codelineno-0-1856"></a>
<a id="__codelineno-0-1857" name="__codelineno-0-1857"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_starts_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1858" name="__codelineno-0-1858"></a>        <span class="n">eval_res</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">struct</span><span class="p">)</span>
<a id="__codelineno-0-1859" name="__codelineno-0-1859"></a>        <span class="k">if</span> <span class="n">eval_res</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">eval_res</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">)):</span>
<a id="__codelineno-0-1860" name="__codelineno-0-1860"></a>            <span class="k">return</span> <span class="n">AlwaysTrue</span><span class="p">()</span>
<a id="__codelineno-0-1861" name="__codelineno-0-1861"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1862" name="__codelineno-0-1862"></a>            <span class="k">return</span> <span class="n">AlwaysFalse</span><span class="p">()</span>
<a id="__codelineno-0-1863" name="__codelineno-0-1863"></a>
<a id="__codelineno-0-1864" name="__codelineno-0-1864"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not_starts_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1865" name="__codelineno-0-1865"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_starts_with</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">literal</span><span class="p">):</span>
<a id="__codelineno-0-1866" name="__codelineno-0-1866"></a>            <span class="k">return</span> <span class="n">AlwaysTrue</span><span class="p">()</span>
<a id="__codelineno-0-1867" name="__codelineno-0-1867"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1868" name="__codelineno-0-1868"></a>            <span class="k">return</span> <span class="n">AlwaysFalse</span><span class="p">()</span>
<a id="__codelineno-0-1869" name="__codelineno-0-1869"></a>
<a id="__codelineno-0-1870" name="__codelineno-0-1870"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_bound_predicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">BoundPredicate</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1871" name="__codelineno-0-1871"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1872" name="__codelineno-0-1872"></a><span class="sd">        If there is no strict projection or if it evaluates to false, then return the predicate.</span>
<a id="__codelineno-0-1873" name="__codelineno-0-1873"></a>
<a id="__codelineno-0-1874" name="__codelineno-0-1874"></a><span class="sd">        Get the strict projection and inclusive projection of this predicate in partition data,</span>
<a id="__codelineno-0-1875" name="__codelineno-0-1875"></a><span class="sd">        then use them to determine whether to return the original predicate. The strict projection</span>
<a id="__codelineno-0-1876" name="__codelineno-0-1876"></a><span class="sd">        returns true iff the original predicate would have returned true, so the predicate can be</span>
<a id="__codelineno-0-1877" name="__codelineno-0-1877"></a><span class="sd">        eliminated if the strict projection evaluates to true. Similarly the inclusive projection</span>
<a id="__codelineno-0-1878" name="__codelineno-0-1878"></a><span class="sd">        returns false iff the original predicate would have returned false, so the predicate can</span>
<a id="__codelineno-0-1879" name="__codelineno-0-1879"></a><span class="sd">        also be eliminated if the inclusive projection evaluates to false.</span>
<a id="__codelineno-0-1880" name="__codelineno-0-1880"></a>
<a id="__codelineno-0-1881" name="__codelineno-0-1881"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1882" name="__codelineno-0-1882"></a>        <span class="n">parts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">fields_by_source_id</span><span class="p">(</span><span class="n">predicate</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">field_id</span><span class="p">)</span>
<a id="__codelineno-0-1883" name="__codelineno-0-1883"></a>        <span class="k">if</span> <span class="n">parts</span> <span class="o">==</span> <span class="p">[]:</span>
<a id="__codelineno-0-1884" name="__codelineno-0-1884"></a>            <span class="k">return</span> <span class="n">predicate</span>
<a id="__codelineno-0-1885" name="__codelineno-0-1885"></a>
<a id="__codelineno-0-1886" name="__codelineno-0-1886"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">struct_to_schema</span><span class="p">(</span><span class="n">struct</span><span class="p">:</span> <span class="n">StructType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Schema</span><span class="p">:</span>
<a id="__codelineno-0-1887" name="__codelineno-0-1887"></a>            <span class="k">return</span> <span class="n">Schema</span><span class="p">(</span><span class="o">*</span><span class="n">struct</span><span class="o">.</span><span class="n">fields</span><span class="p">)</span>
<a id="__codelineno-0-1888" name="__codelineno-0-1888"></a>
<a id="__codelineno-0-1889" name="__codelineno-0-1889"></a>        <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">:</span>
<a id="__codelineno-0-1890" name="__codelineno-0-1890"></a>            <span class="n">strict_projection</span> <span class="o">=</span> <span class="n">part</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">strict_project</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">predicate</span><span class="p">)</span>
<a id="__codelineno-0-1891" name="__codelineno-0-1891"></a>            <span class="n">strict_result</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1892" name="__codelineno-0-1892"></a>
<a id="__codelineno-0-1893" name="__codelineno-0-1893"></a>            <span class="k">if</span> <span class="n">strict_projection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1894" name="__codelineno-0-1894"></a>                <span class="n">bound</span> <span class="o">=</span> <span class="n">strict_projection</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span>
<a id="__codelineno-0-1895" name="__codelineno-0-1895"></a>                    <span class="n">struct_to_schema</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">partition_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">)),</span> <span class="n">case_sensitive</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">case_sensitive</span>
<a id="__codelineno-0-1896" name="__codelineno-0-1896"></a>                <span class="p">)</span>
<a id="__codelineno-0-1897" name="__codelineno-0-1897"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bound</span><span class="p">,</span> <span class="n">BoundPredicate</span><span class="p">):</span>
<a id="__codelineno-0-1898" name="__codelineno-0-1898"></a>                    <span class="n">strict_result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">visit_bound_predicate</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
<a id="__codelineno-0-1899" name="__codelineno-0-1899"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1900" name="__codelineno-0-1900"></a>                    <span class="c1"># if the result is not a predicate, then it must be a constant like alwaysTrue or alwaysFalse</span>
<a id="__codelineno-0-1901" name="__codelineno-0-1901"></a>                    <span class="n">strict_result</span> <span class="o">=</span> <span class="n">bound</span>
<a id="__codelineno-0-1902" name="__codelineno-0-1902"></a>
<a id="__codelineno-0-1903" name="__codelineno-0-1903"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">strict_result</span><span class="p">,</span> <span class="n">AlwaysTrue</span><span class="p">):</span>
<a id="__codelineno-0-1904" name="__codelineno-0-1904"></a>                <span class="k">return</span> <span class="n">AlwaysTrue</span><span class="p">()</span>
<a id="__codelineno-0-1905" name="__codelineno-0-1905"></a>
<a id="__codelineno-0-1906" name="__codelineno-0-1906"></a>            <span class="n">inclusive_projection</span> <span class="o">=</span> <span class="n">part</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">predicate</span><span class="p">)</span>
<a id="__codelineno-0-1907" name="__codelineno-0-1907"></a>            <span class="n">inclusive_result</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1908" name="__codelineno-0-1908"></a>            <span class="k">if</span> <span class="n">inclusive_projection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1909" name="__codelineno-0-1909"></a>                <span class="n">bound_inclusive</span> <span class="o">=</span> <span class="n">inclusive_projection</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span>
<a id="__codelineno-0-1910" name="__codelineno-0-1910"></a>                    <span class="n">struct_to_schema</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">partition_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">)),</span> <span class="n">case_sensitive</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">case_sensitive</span>
<a id="__codelineno-0-1911" name="__codelineno-0-1911"></a>                <span class="p">)</span>
<a id="__codelineno-0-1912" name="__codelineno-0-1912"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bound_inclusive</span><span class="p">,</span> <span class="n">BoundPredicate</span><span class="p">):</span>
<a id="__codelineno-0-1913" name="__codelineno-0-1913"></a>                    <span class="c1"># using predicate method specific to inclusive</span>
<a id="__codelineno-0-1914" name="__codelineno-0-1914"></a>                    <span class="n">inclusive_result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">visit_bound_predicate</span><span class="p">(</span><span class="n">bound_inclusive</span><span class="p">)</span>
<a id="__codelineno-0-1915" name="__codelineno-0-1915"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1916" name="__codelineno-0-1916"></a>                    <span class="c1"># if the result is not a predicate, then it must be a constant like alwaysTrue or</span>
<a id="__codelineno-0-1917" name="__codelineno-0-1917"></a>                    <span class="c1"># alwaysFalse</span>
<a id="__codelineno-0-1918" name="__codelineno-0-1918"></a>                    <span class="n">inclusive_result</span> <span class="o">=</span> <span class="n">bound_inclusive</span>
<a id="__codelineno-0-1919" name="__codelineno-0-1919"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inclusive_result</span><span class="p">,</span> <span class="n">AlwaysFalse</span><span class="p">):</span>
<a id="__codelineno-0-1920" name="__codelineno-0-1920"></a>                <span class="k">return</span> <span class="n">AlwaysFalse</span><span class="p">()</span>
<a id="__codelineno-0-1921" name="__codelineno-0-1921"></a>
<a id="__codelineno-0-1922" name="__codelineno-0-1922"></a>        <span class="k">return</span> <span class="n">predicate</span>
<a id="__codelineno-0-1923" name="__codelineno-0-1923"></a>
<a id="__codelineno-0-1924" name="__codelineno-0-1924"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_unbound_predicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">UnboundPredicate</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1925" name="__codelineno-0-1925"></a>        <span class="n">bound</span> <span class="o">=</span> <span class="n">predicate</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span> <span class="n">case_sensitive</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">case_sensitive</span><span class="p">)</span>
<a id="__codelineno-0-1926" name="__codelineno-0-1926"></a>
<a id="__codelineno-0-1927" name="__codelineno-0-1927"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bound</span><span class="p">,</span> <span class="n">BoundPredicate</span><span class="p">):</span>
<a id="__codelineno-0-1928" name="__codelineno-0-1928"></a>            <span class="n">bound_residual</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_bound_predicate</span><span class="p">(</span><span class="n">predicate</span><span class="o">=</span><span class="n">bound</span><span class="p">)</span>
<a id="__codelineno-0-1929" name="__codelineno-0-1929"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bound_residual</span><span class="p">,</span> <span class="p">(</span><span class="n">AlwaysFalse</span><span class="p">,</span> <span class="n">AlwaysTrue</span><span class="p">)):</span>
<a id="__codelineno-0-1930" name="__codelineno-0-1930"></a>                <span class="c1"># replace inclusive original unbound predicate</span>
<a id="__codelineno-0-1931" name="__codelineno-0-1931"></a>                <span class="k">return</span> <span class="n">predicate</span>
<a id="__codelineno-0-1932" name="__codelineno-0-1932"></a>
<a id="__codelineno-0-1933" name="__codelineno-0-1933"></a>            <span class="c1"># use the non-predicate residual (e.g. alwaysTrue)</span>
<a id="__codelineno-0-1934" name="__codelineno-0-1934"></a>            <span class="k">return</span> <span class="n">bound_residual</span>
<a id="__codelineno-0-1935" name="__codelineno-0-1935"></a>
<a id="__codelineno-0-1936" name="__codelineno-0-1936"></a>        <span class="c1"># if binding didn&#39;t result in a Predicate, return the expression</span>
<a id="__codelineno-0-1937" name="__codelineno-0-1937"></a>        <span class="k">return</span> <span class="n">bound</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors.ResidualVisitor.visit_bound_predicate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit_bound_predicate</span><span class="p">(</span><span class="n">predicate</span><span class="p">)</span></code>

<a href="#pyiceberg.expressions.visitors.ResidualVisitor.visit_bound_predicate" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>If there is no strict projection or if it evaluates to false, then return the predicate.</p>
<p>Get the strict projection and inclusive projection of this predicate in partition data,
then use them to determine whether to return the original predicate. The strict projection
returns true iff the original predicate would have returned true, so the predicate can be
eliminated if the strict projection evaluates to true. Similarly the inclusive projection
returns false iff the original predicate would have returned false, so the predicate can
also be eliminated if the inclusive projection evaluates to false.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1870">1870</a></span>
<span class="normal"><a href="#__codelineno-0-1871">1871</a></span>
<span class="normal"><a href="#__codelineno-0-1872">1872</a></span>
<span class="normal"><a href="#__codelineno-0-1873">1873</a></span>
<span class="normal"><a href="#__codelineno-0-1874">1874</a></span>
<span class="normal"><a href="#__codelineno-0-1875">1875</a></span>
<span class="normal"><a href="#__codelineno-0-1876">1876</a></span>
<span class="normal"><a href="#__codelineno-0-1877">1877</a></span>
<span class="normal"><a href="#__codelineno-0-1878">1878</a></span>
<span class="normal"><a href="#__codelineno-0-1879">1879</a></span>
<span class="normal"><a href="#__codelineno-0-1880">1880</a></span>
<span class="normal"><a href="#__codelineno-0-1881">1881</a></span>
<span class="normal"><a href="#__codelineno-0-1882">1882</a></span>
<span class="normal"><a href="#__codelineno-0-1883">1883</a></span>
<span class="normal"><a href="#__codelineno-0-1884">1884</a></span>
<span class="normal"><a href="#__codelineno-0-1885">1885</a></span>
<span class="normal"><a href="#__codelineno-0-1886">1886</a></span>
<span class="normal"><a href="#__codelineno-0-1887">1887</a></span>
<span class="normal"><a href="#__codelineno-0-1888">1888</a></span>
<span class="normal"><a href="#__codelineno-0-1889">1889</a></span>
<span class="normal"><a href="#__codelineno-0-1890">1890</a></span>
<span class="normal"><a href="#__codelineno-0-1891">1891</a></span>
<span class="normal"><a href="#__codelineno-0-1892">1892</a></span>
<span class="normal"><a href="#__codelineno-0-1893">1893</a></span>
<span class="normal"><a href="#__codelineno-0-1894">1894</a></span>
<span class="normal"><a href="#__codelineno-0-1895">1895</a></span>
<span class="normal"><a href="#__codelineno-0-1896">1896</a></span>
<span class="normal"><a href="#__codelineno-0-1897">1897</a></span>
<span class="normal"><a href="#__codelineno-0-1898">1898</a></span>
<span class="normal"><a href="#__codelineno-0-1899">1899</a></span>
<span class="normal"><a href="#__codelineno-0-1900">1900</a></span>
<span class="normal"><a href="#__codelineno-0-1901">1901</a></span>
<span class="normal"><a href="#__codelineno-0-1902">1902</a></span>
<span class="normal"><a href="#__codelineno-0-1903">1903</a></span>
<span class="normal"><a href="#__codelineno-0-1904">1904</a></span>
<span class="normal"><a href="#__codelineno-0-1905">1905</a></span>
<span class="normal"><a href="#__codelineno-0-1906">1906</a></span>
<span class="normal"><a href="#__codelineno-0-1907">1907</a></span>
<span class="normal"><a href="#__codelineno-0-1908">1908</a></span>
<span class="normal"><a href="#__codelineno-0-1909">1909</a></span>
<span class="normal"><a href="#__codelineno-0-1910">1910</a></span>
<span class="normal"><a href="#__codelineno-0-1911">1911</a></span>
<span class="normal"><a href="#__codelineno-0-1912">1912</a></span>
<span class="normal"><a href="#__codelineno-0-1913">1913</a></span>
<span class="normal"><a href="#__codelineno-0-1914">1914</a></span>
<span class="normal"><a href="#__codelineno-0-1915">1915</a></span>
<span class="normal"><a href="#__codelineno-0-1916">1916</a></span>
<span class="normal"><a href="#__codelineno-0-1917">1917</a></span>
<span class="normal"><a href="#__codelineno-0-1918">1918</a></span>
<span class="normal"><a href="#__codelineno-0-1919">1919</a></span>
<span class="normal"><a href="#__codelineno-0-1920">1920</a></span>
<span class="normal"><a href="#__codelineno-0-1921">1921</a></span>
<span class="normal"><a href="#__codelineno-0-1922">1922</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1870" name="__codelineno-0-1870"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit_bound_predicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">BoundPredicate</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-1871" name="__codelineno-0-1871"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1872" name="__codelineno-0-1872"></a><span class="sd">    If there is no strict projection or if it evaluates to false, then return the predicate.</span>
<a id="__codelineno-0-1873" name="__codelineno-0-1873"></a>
<a id="__codelineno-0-1874" name="__codelineno-0-1874"></a><span class="sd">    Get the strict projection and inclusive projection of this predicate in partition data,</span>
<a id="__codelineno-0-1875" name="__codelineno-0-1875"></a><span class="sd">    then use them to determine whether to return the original predicate. The strict projection</span>
<a id="__codelineno-0-1876" name="__codelineno-0-1876"></a><span class="sd">    returns true iff the original predicate would have returned true, so the predicate can be</span>
<a id="__codelineno-0-1877" name="__codelineno-0-1877"></a><span class="sd">    eliminated if the strict projection evaluates to true. Similarly the inclusive projection</span>
<a id="__codelineno-0-1878" name="__codelineno-0-1878"></a><span class="sd">    returns false iff the original predicate would have returned false, so the predicate can</span>
<a id="__codelineno-0-1879" name="__codelineno-0-1879"></a><span class="sd">    also be eliminated if the inclusive projection evaluates to false.</span>
<a id="__codelineno-0-1880" name="__codelineno-0-1880"></a>
<a id="__codelineno-0-1881" name="__codelineno-0-1881"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1882" name="__codelineno-0-1882"></a>    <span class="n">parts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">fields_by_source_id</span><span class="p">(</span><span class="n">predicate</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">field_id</span><span class="p">)</span>
<a id="__codelineno-0-1883" name="__codelineno-0-1883"></a>    <span class="k">if</span> <span class="n">parts</span> <span class="o">==</span> <span class="p">[]:</span>
<a id="__codelineno-0-1884" name="__codelineno-0-1884"></a>        <span class="k">return</span> <span class="n">predicate</span>
<a id="__codelineno-0-1885" name="__codelineno-0-1885"></a>
<a id="__codelineno-0-1886" name="__codelineno-0-1886"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">struct_to_schema</span><span class="p">(</span><span class="n">struct</span><span class="p">:</span> <span class="n">StructType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Schema</span><span class="p">:</span>
<a id="__codelineno-0-1887" name="__codelineno-0-1887"></a>        <span class="k">return</span> <span class="n">Schema</span><span class="p">(</span><span class="o">*</span><span class="n">struct</span><span class="o">.</span><span class="n">fields</span><span class="p">)</span>
<a id="__codelineno-0-1888" name="__codelineno-0-1888"></a>
<a id="__codelineno-0-1889" name="__codelineno-0-1889"></a>    <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">:</span>
<a id="__codelineno-0-1890" name="__codelineno-0-1890"></a>        <span class="n">strict_projection</span> <span class="o">=</span> <span class="n">part</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">strict_project</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">predicate</span><span class="p">)</span>
<a id="__codelineno-0-1891" name="__codelineno-0-1891"></a>        <span class="n">strict_result</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1892" name="__codelineno-0-1892"></a>
<a id="__codelineno-0-1893" name="__codelineno-0-1893"></a>        <span class="k">if</span> <span class="n">strict_projection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1894" name="__codelineno-0-1894"></a>            <span class="n">bound</span> <span class="o">=</span> <span class="n">strict_projection</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span>
<a id="__codelineno-0-1895" name="__codelineno-0-1895"></a>                <span class="n">struct_to_schema</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">partition_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">)),</span> <span class="n">case_sensitive</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">case_sensitive</span>
<a id="__codelineno-0-1896" name="__codelineno-0-1896"></a>            <span class="p">)</span>
<a id="__codelineno-0-1897" name="__codelineno-0-1897"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bound</span><span class="p">,</span> <span class="n">BoundPredicate</span><span class="p">):</span>
<a id="__codelineno-0-1898" name="__codelineno-0-1898"></a>                <span class="n">strict_result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">visit_bound_predicate</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
<a id="__codelineno-0-1899" name="__codelineno-0-1899"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1900" name="__codelineno-0-1900"></a>                <span class="c1"># if the result is not a predicate, then it must be a constant like alwaysTrue or alwaysFalse</span>
<a id="__codelineno-0-1901" name="__codelineno-0-1901"></a>                <span class="n">strict_result</span> <span class="o">=</span> <span class="n">bound</span>
<a id="__codelineno-0-1902" name="__codelineno-0-1902"></a>
<a id="__codelineno-0-1903" name="__codelineno-0-1903"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">strict_result</span><span class="p">,</span> <span class="n">AlwaysTrue</span><span class="p">):</span>
<a id="__codelineno-0-1904" name="__codelineno-0-1904"></a>            <span class="k">return</span> <span class="n">AlwaysTrue</span><span class="p">()</span>
<a id="__codelineno-0-1905" name="__codelineno-0-1905"></a>
<a id="__codelineno-0-1906" name="__codelineno-0-1906"></a>        <span class="n">inclusive_projection</span> <span class="o">=</span> <span class="n">part</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">predicate</span><span class="p">)</span>
<a id="__codelineno-0-1907" name="__codelineno-0-1907"></a>        <span class="n">inclusive_result</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1908" name="__codelineno-0-1908"></a>        <span class="k">if</span> <span class="n">inclusive_projection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1909" name="__codelineno-0-1909"></a>            <span class="n">bound_inclusive</span> <span class="o">=</span> <span class="n">inclusive_projection</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span>
<a id="__codelineno-0-1910" name="__codelineno-0-1910"></a>                <span class="n">struct_to_schema</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">partition_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">)),</span> <span class="n">case_sensitive</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">case_sensitive</span>
<a id="__codelineno-0-1911" name="__codelineno-0-1911"></a>            <span class="p">)</span>
<a id="__codelineno-0-1912" name="__codelineno-0-1912"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bound_inclusive</span><span class="p">,</span> <span class="n">BoundPredicate</span><span class="p">):</span>
<a id="__codelineno-0-1913" name="__codelineno-0-1913"></a>                <span class="c1"># using predicate method specific to inclusive</span>
<a id="__codelineno-0-1914" name="__codelineno-0-1914"></a>                <span class="n">inclusive_result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">visit_bound_predicate</span><span class="p">(</span><span class="n">bound_inclusive</span><span class="p">)</span>
<a id="__codelineno-0-1915" name="__codelineno-0-1915"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1916" name="__codelineno-0-1916"></a>                <span class="c1"># if the result is not a predicate, then it must be a constant like alwaysTrue or</span>
<a id="__codelineno-0-1917" name="__codelineno-0-1917"></a>                <span class="c1"># alwaysFalse</span>
<a id="__codelineno-0-1918" name="__codelineno-0-1918"></a>                <span class="n">inclusive_result</span> <span class="o">=</span> <span class="n">bound_inclusive</span>
<a id="__codelineno-0-1919" name="__codelineno-0-1919"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inclusive_result</span><span class="p">,</span> <span class="n">AlwaysFalse</span><span class="p">):</span>
<a id="__codelineno-0-1920" name="__codelineno-0-1920"></a>            <span class="k">return</span> <span class="n">AlwaysFalse</span><span class="p">()</span>
<a id="__codelineno-0-1921" name="__codelineno-0-1921"></a>
<a id="__codelineno-0-1922" name="__codelineno-0-1922"></a>    <span class="k">return</span> <span class="n">predicate</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pyiceberg.expressions.visitors._ColumnNameTranslator" class="doc doc-heading">
            <code>_ColumnNameTranslator</code>


<a href="#pyiceberg.expressions.visitors._ColumnNameTranslator" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="pyiceberg.expressions.visitors.BooleanExpressionVisitor" href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor">BooleanExpressionVisitor</a>[<a class="autorefs autorefs-internal" title="pyiceberg.expressions.BooleanExpression" href="../#pyiceberg.expressions.BooleanExpression">BooleanExpression</a>]</code></p>


        <p>Converts the column names with the ones in the actual file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file_schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="pyiceberg.schema.Schema" href="../../schema/#pyiceberg.schema.Schema">Schema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The schema of the file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>case_sensitive</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to consider case when binding a reference to a field in a schema, defaults to True.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>In the case of an UnboundPredicate.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When a column name cannot be found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="k">class</span><span class="w"> </span><span class="nc">_ColumnNameTranslator</span><span class="p">(</span><span class="n">BooleanExpressionVisitor</span><span class="p">[</span><span class="n">BooleanExpression</span><span class="p">]):</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts the column names with the ones in the actual file.</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a><span class="sd">      file_schema (Schema): The schema of the file.</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a><span class="sd">      case_sensitive (bool): Whether to consider case when binding a reference to a field in a schema, defaults to True.</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a><span class="sd">        TypeError: In the case of an UnboundPredicate.</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a><span class="sd">        ValueError: When a column name cannot be found.</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>    <span class="n">file_schema</span><span class="p">:</span> <span class="n">Schema</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>    <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_schema</span><span class="p">:</span> <span class="n">Schema</span><span class="p">,</span> <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file_schema</span> <span class="o">=</span> <span class="n">file_schema</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">case_sensitive</span> <span class="o">=</span> <span class="n">case_sensitive</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_true</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>        <span class="k">return</span> <span class="n">AlwaysTrue</span><span class="p">()</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_false</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>        <span class="k">return</span> <span class="n">AlwaysFalse</span><span class="p">()</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_result</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>        <span class="k">return</span> <span class="n">Not</span><span class="p">(</span><span class="n">child</span><span class="o">=</span><span class="n">child_result</span><span class="p">)</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_and</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_result</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">,</span> <span class="n">right_result</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>        <span class="k">return</span> <span class="n">And</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">left_result</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">right_result</span><span class="p">)</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_or</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_result</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">,</span> <span class="n">right_result</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>        <span class="k">return</span> <span class="n">Or</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">left_result</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">right_result</span><span class="p">)</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_unbound_predicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">UnboundPredicate</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected Bound Predicate, got: </span><span class="si">{</span><span class="n">predicate</span><span class="o">.</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_bound_predicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">BoundPredicate</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>        <span class="n">file_column_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_schema</span><span class="o">.</span><span class="n">find_column_name</span><span class="p">(</span><span class="n">predicate</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">field_id</span><span class="p">)</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>        <span class="k">if</span> <span class="n">file_column_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>            <span class="c1"># In the case of schema evolution, the column might not be present</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>            <span class="c1"># in the file schema when reading older data</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">predicate</span><span class="p">,</span> <span class="n">BoundIsNull</span><span class="p">):</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>                <span class="k">return</span> <span class="n">AlwaysTrue</span><span class="p">()</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>                <span class="k">return</span> <span class="n">AlwaysFalse</span><span class="p">()</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">predicate</span><span class="p">,</span> <span class="n">BoundUnaryPredicate</span><span class="p">):</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>            <span class="k">return</span> <span class="n">predicate</span><span class="o">.</span><span class="n">as_unbound</span><span class="p">(</span><span class="n">file_column_name</span><span class="p">)</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">predicate</span><span class="p">,</span> <span class="n">BoundLiteralPredicate</span><span class="p">):</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>            <span class="k">return</span> <span class="n">predicate</span><span class="o">.</span><span class="n">as_unbound</span><span class="p">(</span><span class="n">file_column_name</span><span class="p">,</span> <span class="n">predicate</span><span class="o">.</span><span class="n">literal</span><span class="p">)</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">predicate</span><span class="p">,</span> <span class="n">BoundSetPredicate</span><span class="p">):</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>            <span class="k">return</span> <span class="n">predicate</span><span class="o">.</span><span class="n">as_unbound</span><span class="p">(</span><span class="n">file_column_name</span><span class="p">,</span> <span class="n">predicate</span><span class="o">.</span><span class="n">literals</span><span class="p">)</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported predicate: </span><span class="si">{</span><span class="n">predicate</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pyiceberg.expressions.visitors._ExpressionFieldIDs" class="doc doc-heading">
            <code>_ExpressionFieldIDs</code>


<a href="#pyiceberg.expressions.visitors._ExpressionFieldIDs" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="pyiceberg.expressions.visitors.BooleanExpressionVisitor" href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor">BooleanExpressionVisitor</a>[<span title="typing.Set">Set</span>[<span title="int">int</span>]]</code></p>


        <p>Extracts the field IDs used in the BooleanExpression.</p>






              <details class="quote">
                <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="k">class</span><span class="w"> </span><span class="nc">_ExpressionFieldIDs</span><span class="p">(</span><span class="n">BooleanExpressionVisitor</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]]):</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts the field IDs used in the BooleanExpression.&quot;&quot;&quot;</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_true</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a>        <span class="k">return</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_false</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>        <span class="k">return</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_result</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>        <span class="k">return</span> <span class="n">child_result</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_and</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_result</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">right_result</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>        <span class="k">return</span> <span class="n">left_result</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">right_result</span><span class="p">)</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_or</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_result</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">right_result</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>        <span class="k">return</span> <span class="n">left_result</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">right_result</span><span class="p">)</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_unbound_predicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">UnboundPredicate</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only works on bound records&quot;</span><span class="p">)</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_bound_predicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">BoundPredicate</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>        <span class="k">return</span> <span class="p">{</span><span class="n">predicate</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">field_id</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pyiceberg.expressions.visitors._InclusiveMetricsEvaluator" class="doc doc-heading">
            <code>_InclusiveMetricsEvaluator</code>


<a href="#pyiceberg.expressions.visitors._InclusiveMetricsEvaluator" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pyiceberg.expressions.visitors._MetricsEvaluator">_MetricsEvaluator</span></code></p>







              <details class="quote">
                <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span>
<span class="normal"><a href="#__codelineno-0-1406">1406</a></span>
<span class="normal"><a href="#__codelineno-0-1407">1407</a></span>
<span class="normal"><a href="#__codelineno-0-1408">1408</a></span>
<span class="normal"><a href="#__codelineno-0-1409">1409</a></span>
<span class="normal"><a href="#__codelineno-0-1410">1410</a></span>
<span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span>
<span class="normal"><a href="#__codelineno-0-1420">1420</a></span>
<span class="normal"><a href="#__codelineno-0-1421">1421</a></span>
<span class="normal"><a href="#__codelineno-0-1422">1422</a></span>
<span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span>
<span class="normal"><a href="#__codelineno-0-1427">1427</a></span>
<span class="normal"><a href="#__codelineno-0-1428">1428</a></span>
<span class="normal"><a href="#__codelineno-0-1429">1429</a></span>
<span class="normal"><a href="#__codelineno-0-1430">1430</a></span>
<span class="normal"><a href="#__codelineno-0-1431">1431</a></span>
<span class="normal"><a href="#__codelineno-0-1432">1432</a></span>
<span class="normal"><a href="#__codelineno-0-1433">1433</a></span>
<span class="normal"><a href="#__codelineno-0-1434">1434</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1138" name="__codelineno-0-1138"></a><span class="k">class</span><span class="w"> </span><span class="nc">_InclusiveMetricsEvaluator</span><span class="p">(</span><span class="n">_MetricsEvaluator</span><span class="p">):</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a>    <span class="n">struct</span><span class="p">:</span> <span class="n">StructType</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a>    <span class="n">expr</span><span class="p">:</span> <span class="n">BooleanExpression</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">Schema</span><span class="p">,</span> <span class="n">expr</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">,</span> <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">include_empty_files</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">struct</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">as_struct</span><span class="p">()</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">include_empty_files</span> <span class="o">=</span> <span class="n">include_empty_files</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">expr</span> <span class="o">=</span> <span class="n">bind</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">rewrite_not</span><span class="p">(</span><span class="n">expr</span><span class="p">),</span> <span class="n">case_sensitive</span><span class="p">)</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="n">DataFile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Test whether the file may contain records that match the expression.&quot;&quot;&quot;</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_empty_files</span> <span class="ow">and</span> <span class="n">file</span><span class="o">.</span><span class="n">record_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>            <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a>        <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">record_count</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>            <span class="c1"># Older version don&#39;t correctly implement record count from avro file and thus</span>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a>            <span class="c1"># set record count -1 when importing avro tables to iceberg tables. This should</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a>            <span class="c1"># be updated once we implemented and set correct record count.</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>            <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value_counts</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">value_counts</span> <span class="ow">or</span> <span class="n">EMPTY_DICT</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">null_counts</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">null_value_counts</span> <span class="ow">or</span> <span class="n">EMPTY_DICT</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nan_counts</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">nan_value_counts</span> <span class="ow">or</span> <span class="n">EMPTY_DICT</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lower_bounds</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">lower_bounds</span> <span class="ow">or</span> <span class="n">EMPTY_DICT</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">upper_bounds</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">upper_bounds</span> <span class="ow">or</span> <span class="n">EMPTY_DICT</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>        <span class="k">return</span> <span class="n">visit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expr</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_may_contain_null</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">null_counts</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">field_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">null_counts</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">null_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_contains_nans_only</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">nan_count</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nan_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">value_count</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">)):</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>            <span class="k">return</span> <span class="n">nan_count</span> <span class="o">==</span> <span class="n">value_count</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_is_null</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">null_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>            <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not_null</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>        <span class="c1"># no need to check whether the field is required because binding evaluates that case</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>        <span class="c1"># if the column has no non-null values, the expression cannot match</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_nulls_only</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>            <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_is_nan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nan_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>            <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>        <span class="c1"># when there&#39;s no nanCounts information, but we already know the column only contains null,</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>        <span class="c1"># it&#39;s guaranteed that there&#39;s no NaN value</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_nulls_only</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>            <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not_nan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_nans_only</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>            <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_less_than</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a>        <span class="n">field</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_nulls_only</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_nans_only</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>            <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">PrimitiveType</span><span class="p">):</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected PrimitiveType: </span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>        <span class="k">if</span> <span class="n">lower_bound_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>            <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">from_bytes</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">lower_bound_bytes</span><span class="p">)</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_nan</span><span class="p">(</span><span class="n">lower_bound</span><span class="p">):</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a>                <span class="c1"># NaN indicates unreliable bounds. See the InclusiveMetricsEvaluator docs for more.</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>                <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a>            <span class="k">if</span> <span class="n">lower_bound</span> <span class="o">&gt;=</span> <span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>  <span class="c1"># type: ignore[operator]</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>                <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_less_than_or_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>        <span class="n">field</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_nulls_only</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_nans_only</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a>            <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">PrimitiveType</span><span class="p">):</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected PrimitiveType: </span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>        <span class="k">if</span> <span class="n">lower_bound_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>            <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">from_bytes</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">lower_bound_bytes</span><span class="p">)</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_nan</span><span class="p">(</span><span class="n">lower_bound</span><span class="p">):</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a>                <span class="c1"># NaN indicates unreliable bounds. See the InclusiveMetricsEvaluator docs for more.</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a>                <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>            <span class="k">if</span> <span class="n">lower_bound</span> <span class="o">&gt;</span> <span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>  <span class="c1"># type: ignore[operator]</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a>                <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_greater_than</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a>        <span class="n">field</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_nulls_only</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_nans_only</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a>            <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">PrimitiveType</span><span class="p">):</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected PrimitiveType: </span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a>        <span class="k">if</span> <span class="n">upper_bound_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a>            <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">from_bytes</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">upper_bound_bytes</span><span class="p">)</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a>            <span class="k">if</span> <span class="n">upper_bound</span> <span class="o">&lt;=</span> <span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>  <span class="c1"># type: ignore[operator]</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_nan</span><span class="p">(</span><span class="n">upper_bound</span><span class="p">):</span>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a>                    <span class="c1"># NaN indicates unreliable bounds. See the InclusiveMetricsEvaluator docs for more.</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a>                    <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>                <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_greater_than_or_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>        <span class="n">field</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_nulls_only</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_nans_only</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a>            <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">PrimitiveType</span><span class="p">):</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected PrimitiveType: </span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>        <span class="k">if</span> <span class="n">upper_bound_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a>            <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">from_bytes</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">upper_bound_bytes</span><span class="p">)</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a>            <span class="k">if</span> <span class="n">upper_bound</span> <span class="o">&lt;</span> <span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>  <span class="c1"># type: ignore[operator]</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_nan</span><span class="p">(</span><span class="n">upper_bound</span><span class="p">):</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a>                    <span class="c1"># NaN indicates unreliable bounds. See the InclusiveMetricsEvaluator docs for more.</span>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a>                    <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a>                <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a>        <span class="n">field</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_nulls_only</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_nans_only</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a>            <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a>
<a id="__codelineno-0-1307" name="__codelineno-0-1307"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">PrimitiveType</span><span class="p">):</span>
<a id="__codelineno-0-1308" name="__codelineno-0-1308"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected PrimitiveType: </span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1309" name="__codelineno-0-1309"></a>
<a id="__codelineno-0-1310" name="__codelineno-0-1310"></a>        <span class="k">if</span> <span class="n">lower_bound_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a>            <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">from_bytes</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">lower_bound_bytes</span><span class="p">)</span>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_nan</span><span class="p">(</span><span class="n">lower_bound</span><span class="p">):</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a>                <span class="c1"># NaN indicates unreliable bounds. See the InclusiveMetricsEvaluator docs for more.</span>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a>                <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1315" name="__codelineno-0-1315"></a>
<a id="__codelineno-0-1316" name="__codelineno-0-1316"></a>            <span class="k">if</span> <span class="n">lower_bound</span> <span class="o">&gt;</span> <span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>  <span class="c1"># type: ignore[operator]</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a>                <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a>        <span class="k">if</span> <span class="n">upper_bound_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a>            <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">from_bytes</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">upper_bound_bytes</span><span class="p">)</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_nan</span><span class="p">(</span><span class="n">upper_bound</span><span class="p">):</span>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a>                <span class="c1"># NaN indicates unreliable bounds. See the InclusiveMetricsEvaluator docs for more.</span>
<a id="__codelineno-0-1323" name="__codelineno-0-1323"></a>                <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1324" name="__codelineno-0-1324"></a>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a>            <span class="k">if</span> <span class="n">upper_bound</span> <span class="o">&lt;</span> <span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>  <span class="c1"># type: ignore[operator]</span>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a>                <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1331" name="__codelineno-0-1331"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1332" name="__codelineno-0-1332"></a>
<a id="__codelineno-0-1333" name="__codelineno-0-1333"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literals</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1334" name="__codelineno-0-1334"></a>        <span class="n">field</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span>
<a id="__codelineno-0-1335" name="__codelineno-0-1335"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1336" name="__codelineno-0-1336"></a>
<a id="__codelineno-0-1337" name="__codelineno-0-1337"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_nulls_only</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_nans_only</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1338" name="__codelineno-0-1338"></a>            <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1339" name="__codelineno-0-1339"></a>
<a id="__codelineno-0-1340" name="__codelineno-0-1340"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">literals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">IN_PREDICATE_LIMIT</span><span class="p">:</span>
<a id="__codelineno-0-1341" name="__codelineno-0-1341"></a>            <span class="c1"># skip evaluating the predicate if the number of values is too big</span>
<a id="__codelineno-0-1342" name="__codelineno-0-1342"></a>            <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1343" name="__codelineno-0-1343"></a>
<a id="__codelineno-0-1344" name="__codelineno-0-1344"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">PrimitiveType</span><span class="p">):</span>
<a id="__codelineno-0-1345" name="__codelineno-0-1345"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected PrimitiveType: </span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1346" name="__codelineno-0-1346"></a>
<a id="__codelineno-0-1347" name="__codelineno-0-1347"></a>        <span class="k">if</span> <span class="n">lower_bound_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1348" name="__codelineno-0-1348"></a>            <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">from_bytes</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">lower_bound_bytes</span><span class="p">)</span>
<a id="__codelineno-0-1349" name="__codelineno-0-1349"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_nan</span><span class="p">(</span><span class="n">lower_bound</span><span class="p">):</span>
<a id="__codelineno-0-1350" name="__codelineno-0-1350"></a>                <span class="c1"># NaN indicates unreliable bounds. See the InclusiveMetricsEvaluator docs for more.</span>
<a id="__codelineno-0-1351" name="__codelineno-0-1351"></a>                <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1352" name="__codelineno-0-1352"></a>
<a id="__codelineno-0-1353" name="__codelineno-0-1353"></a>            <span class="n">literals</span> <span class="o">=</span> <span class="p">{</span><span class="n">lit</span> <span class="k">for</span> <span class="n">lit</span> <span class="ow">in</span> <span class="n">literals</span> <span class="k">if</span> <span class="n">lower_bound</span> <span class="o">&lt;=</span> <span class="n">lit</span><span class="p">}</span>  <span class="c1"># type: ignore[operator]</span>
<a id="__codelineno-0-1354" name="__codelineno-0-1354"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">literals</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1355" name="__codelineno-0-1355"></a>                <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1356" name="__codelineno-0-1356"></a>
<a id="__codelineno-0-1357" name="__codelineno-0-1357"></a>        <span class="k">if</span> <span class="n">upper_bound_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1358" name="__codelineno-0-1358"></a>            <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">from_bytes</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">upper_bound_bytes</span><span class="p">)</span>
<a id="__codelineno-0-1359" name="__codelineno-0-1359"></a>            <span class="c1"># this is different from Java, here NaN is always larger</span>
<a id="__codelineno-0-1360" name="__codelineno-0-1360"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_nan</span><span class="p">(</span><span class="n">upper_bound</span><span class="p">):</span>
<a id="__codelineno-0-1361" name="__codelineno-0-1361"></a>                <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1362" name="__codelineno-0-1362"></a>
<a id="__codelineno-0-1363" name="__codelineno-0-1363"></a>            <span class="n">literals</span> <span class="o">=</span> <span class="p">{</span><span class="n">lit</span> <span class="k">for</span> <span class="n">lit</span> <span class="ow">in</span> <span class="n">literals</span> <span class="k">if</span> <span class="n">upper_bound</span> <span class="o">&gt;=</span> <span class="n">lit</span><span class="p">}</span>  <span class="c1"># type: ignore[operator]</span>
<a id="__codelineno-0-1364" name="__codelineno-0-1364"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">literals</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1365" name="__codelineno-0-1365"></a>                <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1366" name="__codelineno-0-1366"></a>
<a id="__codelineno-0-1367" name="__codelineno-0-1367"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>
<a id="__codelineno-0-1369" name="__codelineno-0-1369"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literals</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1370" name="__codelineno-0-1370"></a>        <span class="c1"># because the bounds are not necessarily a min or max value, this cannot be answered using</span>
<a id="__codelineno-0-1371" name="__codelineno-0-1371"></a>        <span class="c1"># them. notIn(col, {X, ...}) with (X, Y) doesn&#39;t guarantee that X is a value in col.</span>
<a id="__codelineno-0-1372" name="__codelineno-0-1372"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1373" name="__codelineno-0-1373"></a>
<a id="__codelineno-0-1374" name="__codelineno-0-1374"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_starts_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1375" name="__codelineno-0-1375"></a>        <span class="n">field</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span>
<a id="__codelineno-0-1376" name="__codelineno-0-1376"></a>        <span class="n">field_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1377" name="__codelineno-0-1377"></a>
<a id="__codelineno-0-1378" name="__codelineno-0-1378"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_nulls_only</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1379" name="__codelineno-0-1379"></a>            <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1380" name="__codelineno-0-1380"></a>
<a id="__codelineno-0-1381" name="__codelineno-0-1381"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">PrimitiveType</span><span class="p">):</span>
<a id="__codelineno-0-1382" name="__codelineno-0-1382"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected PrimitiveType: </span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1383" name="__codelineno-0-1383"></a>
<a id="__codelineno-0-1384" name="__codelineno-0-1384"></a>        <span class="n">prefix</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1385" name="__codelineno-0-1385"></a>        <span class="n">len_prefix</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
<a id="__codelineno-0-1386" name="__codelineno-0-1386"></a>
<a id="__codelineno-0-1387" name="__codelineno-0-1387"></a>        <span class="k">if</span> <span class="n">lower_bound_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1388" name="__codelineno-0-1388"></a>            <span class="n">lower_bound</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">lower_bound_bytes</span><span class="p">))</span>
<a id="__codelineno-0-1389" name="__codelineno-0-1389"></a>
<a id="__codelineno-0-1390" name="__codelineno-0-1390"></a>            <span class="c1"># truncate lower bound so that its length is not greater than the length of prefix</span>
<a id="__codelineno-0-1391" name="__codelineno-0-1391"></a>            <span class="k">if</span> <span class="n">lower_bound</span> <span class="ow">and</span> <span class="n">lower_bound</span><span class="p">[:</span><span class="n">len_prefix</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">prefix</span><span class="p">:</span>
<a id="__codelineno-0-1392" name="__codelineno-0-1392"></a>                <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1393" name="__codelineno-0-1393"></a>
<a id="__codelineno-0-1394" name="__codelineno-0-1394"></a>        <span class="k">if</span> <span class="n">upper_bound_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1395" name="__codelineno-0-1395"></a>            <span class="n">upper_bound</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">upper_bound_bytes</span><span class="p">))</span>
<a id="__codelineno-0-1396" name="__codelineno-0-1396"></a>
<a id="__codelineno-0-1397" name="__codelineno-0-1397"></a>            <span class="c1"># truncate upper bound so that its length is not greater than the length of prefix</span>
<a id="__codelineno-0-1398" name="__codelineno-0-1398"></a>            <span class="k">if</span> <span class="n">upper_bound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">upper_bound</span><span class="p">[:</span><span class="n">len_prefix</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">prefix</span><span class="p">:</span>
<a id="__codelineno-0-1399" name="__codelineno-0-1399"></a>                <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1400" name="__codelineno-0-1400"></a>
<a id="__codelineno-0-1401" name="__codelineno-0-1401"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1402" name="__codelineno-0-1402"></a>
<a id="__codelineno-0-1403" name="__codelineno-0-1403"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not_starts_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1404" name="__codelineno-0-1404"></a>        <span class="n">field</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span>
<a id="__codelineno-0-1405" name="__codelineno-0-1405"></a>        <span class="n">field_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1406" name="__codelineno-0-1406"></a>
<a id="__codelineno-0-1407" name="__codelineno-0-1407"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_may_contain_null</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1408" name="__codelineno-0-1408"></a>            <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1409" name="__codelineno-0-1409"></a>
<a id="__codelineno-0-1410" name="__codelineno-0-1410"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">PrimitiveType</span><span class="p">):</span>
<a id="__codelineno-0-1411" name="__codelineno-0-1411"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected PrimitiveType: </span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1412" name="__codelineno-0-1412"></a>
<a id="__codelineno-0-1413" name="__codelineno-0-1413"></a>        <span class="n">prefix</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1414" name="__codelineno-0-1414"></a>        <span class="n">len_prefix</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
<a id="__codelineno-0-1415" name="__codelineno-0-1415"></a>
<a id="__codelineno-0-1416" name="__codelineno-0-1416"></a>        <span class="c1"># not_starts_with will match unless all values must start with the prefix. This happens when</span>
<a id="__codelineno-0-1417" name="__codelineno-0-1417"></a>        <span class="c1"># the lower and upper bounds both start with the prefix.</span>
<a id="__codelineno-0-1418" name="__codelineno-0-1418"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">lower_bound_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">upper_bound_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">)):</span>
<a id="__codelineno-0-1419" name="__codelineno-0-1419"></a>            <span class="n">lower_bound</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">lower_bound_bytes</span><span class="p">))</span>
<a id="__codelineno-0-1420" name="__codelineno-0-1420"></a>            <span class="n">upper_bound</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">upper_bound_bytes</span><span class="p">))</span>
<a id="__codelineno-0-1421" name="__codelineno-0-1421"></a>
<a id="__codelineno-0-1422" name="__codelineno-0-1422"></a>            <span class="c1"># if lower is shorter than the prefix then lower doesn&#39;t start with the prefix</span>
<a id="__codelineno-0-1423" name="__codelineno-0-1423"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lower_bound</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">len_prefix</span><span class="p">:</span>
<a id="__codelineno-0-1424" name="__codelineno-0-1424"></a>                <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1425" name="__codelineno-0-1425"></a>
<a id="__codelineno-0-1426" name="__codelineno-0-1426"></a>            <span class="k">if</span> <span class="n">lower_bound</span><span class="p">[:</span><span class="n">len_prefix</span><span class="p">]</span> <span class="o">==</span> <span class="n">prefix</span><span class="p">:</span>
<a id="__codelineno-0-1427" name="__codelineno-0-1427"></a>                <span class="c1"># if upper is shorter than the prefix then upper can&#39;t start with the prefix</span>
<a id="__codelineno-0-1428" name="__codelineno-0-1428"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">upper_bound</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">len_prefix</span><span class="p">:</span>
<a id="__codelineno-0-1429" name="__codelineno-0-1429"></a>                    <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1430" name="__codelineno-0-1430"></a>
<a id="__codelineno-0-1431" name="__codelineno-0-1431"></a>                <span class="k">if</span> <span class="n">upper_bound</span><span class="p">[:</span><span class="n">len_prefix</span><span class="p">]</span> <span class="o">==</span> <span class="n">prefix</span><span class="p">:</span>
<a id="__codelineno-0-1432" name="__codelineno-0-1432"></a>                    <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1433" name="__codelineno-0-1433"></a>
<a id="__codelineno-0-1434" name="__codelineno-0-1434"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors._InclusiveMetricsEvaluator.eval" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">eval</span><span class="p">(</span><span class="n">file</span><span class="p">)</span></code>

<a href="#pyiceberg.expressions.visitors._InclusiveMetricsEvaluator.eval" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test whether the file may contain records that match the expression.</p>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="k">def</span><span class="w"> </span><span class="nf">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="n">DataFile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test whether the file may contain records that match the expression.&quot;&quot;&quot;</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_empty_files</span> <span class="ow">and</span> <span class="n">file</span><span class="o">.</span><span class="n">record_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>        <span class="k">return</span> <span class="n">ROWS_CANNOT_MATCH</span>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a>    <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">record_count</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>        <span class="c1"># Older version don&#39;t correctly implement record count from avro file and thus</span>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a>        <span class="c1"># set record count -1 when importing avro tables to iceberg tables. This should</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a>        <span class="c1"># be updated once we implemented and set correct record count.</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_MATCH</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">value_counts</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">value_counts</span> <span class="ow">or</span> <span class="n">EMPTY_DICT</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">null_counts</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">null_value_counts</span> <span class="ow">or</span> <span class="n">EMPTY_DICT</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">nan_counts</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">nan_value_counts</span> <span class="ow">or</span> <span class="n">EMPTY_DICT</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">lower_bounds</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">lower_bounds</span> <span class="ow">or</span> <span class="n">EMPTY_DICT</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">upper_bounds</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">upper_bounds</span> <span class="ow">or</span> <span class="n">EMPTY_DICT</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>    <span class="k">return</span> <span class="n">visit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expr</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pyiceberg.expressions.visitors._RewriteNotVisitor" class="doc doc-heading">
            <code>_RewriteNotVisitor</code>


<a href="#pyiceberg.expressions.visitors._RewriteNotVisitor" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="pyiceberg.expressions.visitors.BooleanExpressionVisitor" href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor">BooleanExpressionVisitor</a>[<a class="autorefs autorefs-internal" title="pyiceberg.expressions.BooleanExpression" href="../#pyiceberg.expressions.BooleanExpression">BooleanExpression</a>]</code></p>


        <p>Inverts the negations.</p>






              <details class="quote">
                <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="k">class</span><span class="w"> </span><span class="nc">_RewriteNotVisitor</span><span class="p">(</span><span class="n">BooleanExpressionVisitor</span><span class="p">[</span><span class="n">BooleanExpression</span><span class="p">]):</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverts the negations.&quot;&quot;&quot;</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_true</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>        <span class="k">return</span> <span class="n">AlwaysTrue</span><span class="p">()</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_false</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>        <span class="k">return</span> <span class="n">AlwaysFalse</span><span class="p">()</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_result</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>        <span class="k">return</span> <span class="o">~</span><span class="n">child_result</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_and</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_result</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">,</span> <span class="n">right_result</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>        <span class="k">return</span> <span class="n">And</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">left_result</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">right_result</span><span class="p">)</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_or</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_result</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">,</span> <span class="n">right_result</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>        <span class="k">return</span> <span class="n">Or</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">left_result</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">right_result</span><span class="p">)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_unbound_predicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">UnboundPredicate</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="k">return</span> <span class="n">predicate</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_bound_predicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">BoundPredicate</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>        <span class="k">return</span> <span class="n">predicate</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pyiceberg.expressions.visitors._StrictMetricsEvaluator" class="doc doc-heading">
            <code>_StrictMetricsEvaluator</code>


<a href="#pyiceberg.expressions.visitors._StrictMetricsEvaluator" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pyiceberg.expressions.visitors._MetricsEvaluator">_MetricsEvaluator</span></code></p>







              <details class="quote">
                <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1461">1461</a></span>
<span class="normal"><a href="#__codelineno-0-1462">1462</a></span>
<span class="normal"><a href="#__codelineno-0-1463">1463</a></span>
<span class="normal"><a href="#__codelineno-0-1464">1464</a></span>
<span class="normal"><a href="#__codelineno-0-1465">1465</a></span>
<span class="normal"><a href="#__codelineno-0-1466">1466</a></span>
<span class="normal"><a href="#__codelineno-0-1467">1467</a></span>
<span class="normal"><a href="#__codelineno-0-1468">1468</a></span>
<span class="normal"><a href="#__codelineno-0-1469">1469</a></span>
<span class="normal"><a href="#__codelineno-0-1470">1470</a></span>
<span class="normal"><a href="#__codelineno-0-1471">1471</a></span>
<span class="normal"><a href="#__codelineno-0-1472">1472</a></span>
<span class="normal"><a href="#__codelineno-0-1473">1473</a></span>
<span class="normal"><a href="#__codelineno-0-1474">1474</a></span>
<span class="normal"><a href="#__codelineno-0-1475">1475</a></span>
<span class="normal"><a href="#__codelineno-0-1476">1476</a></span>
<span class="normal"><a href="#__codelineno-0-1477">1477</a></span>
<span class="normal"><a href="#__codelineno-0-1478">1478</a></span>
<span class="normal"><a href="#__codelineno-0-1479">1479</a></span>
<span class="normal"><a href="#__codelineno-0-1480">1480</a></span>
<span class="normal"><a href="#__codelineno-0-1481">1481</a></span>
<span class="normal"><a href="#__codelineno-0-1482">1482</a></span>
<span class="normal"><a href="#__codelineno-0-1483">1483</a></span>
<span class="normal"><a href="#__codelineno-0-1484">1484</a></span>
<span class="normal"><a href="#__codelineno-0-1485">1485</a></span>
<span class="normal"><a href="#__codelineno-0-1486">1486</a></span>
<span class="normal"><a href="#__codelineno-0-1487">1487</a></span>
<span class="normal"><a href="#__codelineno-0-1488">1488</a></span>
<span class="normal"><a href="#__codelineno-0-1489">1489</a></span>
<span class="normal"><a href="#__codelineno-0-1490">1490</a></span>
<span class="normal"><a href="#__codelineno-0-1491">1491</a></span>
<span class="normal"><a href="#__codelineno-0-1492">1492</a></span>
<span class="normal"><a href="#__codelineno-0-1493">1493</a></span>
<span class="normal"><a href="#__codelineno-0-1494">1494</a></span>
<span class="normal"><a href="#__codelineno-0-1495">1495</a></span>
<span class="normal"><a href="#__codelineno-0-1496">1496</a></span>
<span class="normal"><a href="#__codelineno-0-1497">1497</a></span>
<span class="normal"><a href="#__codelineno-0-1498">1498</a></span>
<span class="normal"><a href="#__codelineno-0-1499">1499</a></span>
<span class="normal"><a href="#__codelineno-0-1500">1500</a></span>
<span class="normal"><a href="#__codelineno-0-1501">1501</a></span>
<span class="normal"><a href="#__codelineno-0-1502">1502</a></span>
<span class="normal"><a href="#__codelineno-0-1503">1503</a></span>
<span class="normal"><a href="#__codelineno-0-1504">1504</a></span>
<span class="normal"><a href="#__codelineno-0-1505">1505</a></span>
<span class="normal"><a href="#__codelineno-0-1506">1506</a></span>
<span class="normal"><a href="#__codelineno-0-1507">1507</a></span>
<span class="normal"><a href="#__codelineno-0-1508">1508</a></span>
<span class="normal"><a href="#__codelineno-0-1509">1509</a></span>
<span class="normal"><a href="#__codelineno-0-1510">1510</a></span>
<span class="normal"><a href="#__codelineno-0-1511">1511</a></span>
<span class="normal"><a href="#__codelineno-0-1512">1512</a></span>
<span class="normal"><a href="#__codelineno-0-1513">1513</a></span>
<span class="normal"><a href="#__codelineno-0-1514">1514</a></span>
<span class="normal"><a href="#__codelineno-0-1515">1515</a></span>
<span class="normal"><a href="#__codelineno-0-1516">1516</a></span>
<span class="normal"><a href="#__codelineno-0-1517">1517</a></span>
<span class="normal"><a href="#__codelineno-0-1518">1518</a></span>
<span class="normal"><a href="#__codelineno-0-1519">1519</a></span>
<span class="normal"><a href="#__codelineno-0-1520">1520</a></span>
<span class="normal"><a href="#__codelineno-0-1521">1521</a></span>
<span class="normal"><a href="#__codelineno-0-1522">1522</a></span>
<span class="normal"><a href="#__codelineno-0-1523">1523</a></span>
<span class="normal"><a href="#__codelineno-0-1524">1524</a></span>
<span class="normal"><a href="#__codelineno-0-1525">1525</a></span>
<span class="normal"><a href="#__codelineno-0-1526">1526</a></span>
<span class="normal"><a href="#__codelineno-0-1527">1527</a></span>
<span class="normal"><a href="#__codelineno-0-1528">1528</a></span>
<span class="normal"><a href="#__codelineno-0-1529">1529</a></span>
<span class="normal"><a href="#__codelineno-0-1530">1530</a></span>
<span class="normal"><a href="#__codelineno-0-1531">1531</a></span>
<span class="normal"><a href="#__codelineno-0-1532">1532</a></span>
<span class="normal"><a href="#__codelineno-0-1533">1533</a></span>
<span class="normal"><a href="#__codelineno-0-1534">1534</a></span>
<span class="normal"><a href="#__codelineno-0-1535">1535</a></span>
<span class="normal"><a href="#__codelineno-0-1536">1536</a></span>
<span class="normal"><a href="#__codelineno-0-1537">1537</a></span>
<span class="normal"><a href="#__codelineno-0-1538">1538</a></span>
<span class="normal"><a href="#__codelineno-0-1539">1539</a></span>
<span class="normal"><a href="#__codelineno-0-1540">1540</a></span>
<span class="normal"><a href="#__codelineno-0-1541">1541</a></span>
<span class="normal"><a href="#__codelineno-0-1542">1542</a></span>
<span class="normal"><a href="#__codelineno-0-1543">1543</a></span>
<span class="normal"><a href="#__codelineno-0-1544">1544</a></span>
<span class="normal"><a href="#__codelineno-0-1545">1545</a></span>
<span class="normal"><a href="#__codelineno-0-1546">1546</a></span>
<span class="normal"><a href="#__codelineno-0-1547">1547</a></span>
<span class="normal"><a href="#__codelineno-0-1548">1548</a></span>
<span class="normal"><a href="#__codelineno-0-1549">1549</a></span>
<span class="normal"><a href="#__codelineno-0-1550">1550</a></span>
<span class="normal"><a href="#__codelineno-0-1551">1551</a></span>
<span class="normal"><a href="#__codelineno-0-1552">1552</a></span>
<span class="normal"><a href="#__codelineno-0-1553">1553</a></span>
<span class="normal"><a href="#__codelineno-0-1554">1554</a></span>
<span class="normal"><a href="#__codelineno-0-1555">1555</a></span>
<span class="normal"><a href="#__codelineno-0-1556">1556</a></span>
<span class="normal"><a href="#__codelineno-0-1557">1557</a></span>
<span class="normal"><a href="#__codelineno-0-1558">1558</a></span>
<span class="normal"><a href="#__codelineno-0-1559">1559</a></span>
<span class="normal"><a href="#__codelineno-0-1560">1560</a></span>
<span class="normal"><a href="#__codelineno-0-1561">1561</a></span>
<span class="normal"><a href="#__codelineno-0-1562">1562</a></span>
<span class="normal"><a href="#__codelineno-0-1563">1563</a></span>
<span class="normal"><a href="#__codelineno-0-1564">1564</a></span>
<span class="normal"><a href="#__codelineno-0-1565">1565</a></span>
<span class="normal"><a href="#__codelineno-0-1566">1566</a></span>
<span class="normal"><a href="#__codelineno-0-1567">1567</a></span>
<span class="normal"><a href="#__codelineno-0-1568">1568</a></span>
<span class="normal"><a href="#__codelineno-0-1569">1569</a></span>
<span class="normal"><a href="#__codelineno-0-1570">1570</a></span>
<span class="normal"><a href="#__codelineno-0-1571">1571</a></span>
<span class="normal"><a href="#__codelineno-0-1572">1572</a></span>
<span class="normal"><a href="#__codelineno-0-1573">1573</a></span>
<span class="normal"><a href="#__codelineno-0-1574">1574</a></span>
<span class="normal"><a href="#__codelineno-0-1575">1575</a></span>
<span class="normal"><a href="#__codelineno-0-1576">1576</a></span>
<span class="normal"><a href="#__codelineno-0-1577">1577</a></span>
<span class="normal"><a href="#__codelineno-0-1578">1578</a></span>
<span class="normal"><a href="#__codelineno-0-1579">1579</a></span>
<span class="normal"><a href="#__codelineno-0-1580">1580</a></span>
<span class="normal"><a href="#__codelineno-0-1581">1581</a></span>
<span class="normal"><a href="#__codelineno-0-1582">1582</a></span>
<span class="normal"><a href="#__codelineno-0-1583">1583</a></span>
<span class="normal"><a href="#__codelineno-0-1584">1584</a></span>
<span class="normal"><a href="#__codelineno-0-1585">1585</a></span>
<span class="normal"><a href="#__codelineno-0-1586">1586</a></span>
<span class="normal"><a href="#__codelineno-0-1587">1587</a></span>
<span class="normal"><a href="#__codelineno-0-1588">1588</a></span>
<span class="normal"><a href="#__codelineno-0-1589">1589</a></span>
<span class="normal"><a href="#__codelineno-0-1590">1590</a></span>
<span class="normal"><a href="#__codelineno-0-1591">1591</a></span>
<span class="normal"><a href="#__codelineno-0-1592">1592</a></span>
<span class="normal"><a href="#__codelineno-0-1593">1593</a></span>
<span class="normal"><a href="#__codelineno-0-1594">1594</a></span>
<span class="normal"><a href="#__codelineno-0-1595">1595</a></span>
<span class="normal"><a href="#__codelineno-0-1596">1596</a></span>
<span class="normal"><a href="#__codelineno-0-1597">1597</a></span>
<span class="normal"><a href="#__codelineno-0-1598">1598</a></span>
<span class="normal"><a href="#__codelineno-0-1599">1599</a></span>
<span class="normal"><a href="#__codelineno-0-1600">1600</a></span>
<span class="normal"><a href="#__codelineno-0-1601">1601</a></span>
<span class="normal"><a href="#__codelineno-0-1602">1602</a></span>
<span class="normal"><a href="#__codelineno-0-1603">1603</a></span>
<span class="normal"><a href="#__codelineno-0-1604">1604</a></span>
<span class="normal"><a href="#__codelineno-0-1605">1605</a></span>
<span class="normal"><a href="#__codelineno-0-1606">1606</a></span>
<span class="normal"><a href="#__codelineno-0-1607">1607</a></span>
<span class="normal"><a href="#__codelineno-0-1608">1608</a></span>
<span class="normal"><a href="#__codelineno-0-1609">1609</a></span>
<span class="normal"><a href="#__codelineno-0-1610">1610</a></span>
<span class="normal"><a href="#__codelineno-0-1611">1611</a></span>
<span class="normal"><a href="#__codelineno-0-1612">1612</a></span>
<span class="normal"><a href="#__codelineno-0-1613">1613</a></span>
<span class="normal"><a href="#__codelineno-0-1614">1614</a></span>
<span class="normal"><a href="#__codelineno-0-1615">1615</a></span>
<span class="normal"><a href="#__codelineno-0-1616">1616</a></span>
<span class="normal"><a href="#__codelineno-0-1617">1617</a></span>
<span class="normal"><a href="#__codelineno-0-1618">1618</a></span>
<span class="normal"><a href="#__codelineno-0-1619">1619</a></span>
<span class="normal"><a href="#__codelineno-0-1620">1620</a></span>
<span class="normal"><a href="#__codelineno-0-1621">1621</a></span>
<span class="normal"><a href="#__codelineno-0-1622">1622</a></span>
<span class="normal"><a href="#__codelineno-0-1623">1623</a></span>
<span class="normal"><a href="#__codelineno-0-1624">1624</a></span>
<span class="normal"><a href="#__codelineno-0-1625">1625</a></span>
<span class="normal"><a href="#__codelineno-0-1626">1626</a></span>
<span class="normal"><a href="#__codelineno-0-1627">1627</a></span>
<span class="normal"><a href="#__codelineno-0-1628">1628</a></span>
<span class="normal"><a href="#__codelineno-0-1629">1629</a></span>
<span class="normal"><a href="#__codelineno-0-1630">1630</a></span>
<span class="normal"><a href="#__codelineno-0-1631">1631</a></span>
<span class="normal"><a href="#__codelineno-0-1632">1632</a></span>
<span class="normal"><a href="#__codelineno-0-1633">1633</a></span>
<span class="normal"><a href="#__codelineno-0-1634">1634</a></span>
<span class="normal"><a href="#__codelineno-0-1635">1635</a></span>
<span class="normal"><a href="#__codelineno-0-1636">1636</a></span>
<span class="normal"><a href="#__codelineno-0-1637">1637</a></span>
<span class="normal"><a href="#__codelineno-0-1638">1638</a></span>
<span class="normal"><a href="#__codelineno-0-1639">1639</a></span>
<span class="normal"><a href="#__codelineno-0-1640">1640</a></span>
<span class="normal"><a href="#__codelineno-0-1641">1641</a></span>
<span class="normal"><a href="#__codelineno-0-1642">1642</a></span>
<span class="normal"><a href="#__codelineno-0-1643">1643</a></span>
<span class="normal"><a href="#__codelineno-0-1644">1644</a></span>
<span class="normal"><a href="#__codelineno-0-1645">1645</a></span>
<span class="normal"><a href="#__codelineno-0-1646">1646</a></span>
<span class="normal"><a href="#__codelineno-0-1647">1647</a></span>
<span class="normal"><a href="#__codelineno-0-1648">1648</a></span>
<span class="normal"><a href="#__codelineno-0-1649">1649</a></span>
<span class="normal"><a href="#__codelineno-0-1650">1650</a></span>
<span class="normal"><a href="#__codelineno-0-1651">1651</a></span>
<span class="normal"><a href="#__codelineno-0-1652">1652</a></span>
<span class="normal"><a href="#__codelineno-0-1653">1653</a></span>
<span class="normal"><a href="#__codelineno-0-1654">1654</a></span>
<span class="normal"><a href="#__codelineno-0-1655">1655</a></span>
<span class="normal"><a href="#__codelineno-0-1656">1656</a></span>
<span class="normal"><a href="#__codelineno-0-1657">1657</a></span>
<span class="normal"><a href="#__codelineno-0-1658">1658</a></span>
<span class="normal"><a href="#__codelineno-0-1659">1659</a></span>
<span class="normal"><a href="#__codelineno-0-1660">1660</a></span>
<span class="normal"><a href="#__codelineno-0-1661">1661</a></span>
<span class="normal"><a href="#__codelineno-0-1662">1662</a></span>
<span class="normal"><a href="#__codelineno-0-1663">1663</a></span>
<span class="normal"><a href="#__codelineno-0-1664">1664</a></span>
<span class="normal"><a href="#__codelineno-0-1665">1665</a></span>
<span class="normal"><a href="#__codelineno-0-1666">1666</a></span>
<span class="normal"><a href="#__codelineno-0-1667">1667</a></span>
<span class="normal"><a href="#__codelineno-0-1668">1668</a></span>
<span class="normal"><a href="#__codelineno-0-1669">1669</a></span>
<span class="normal"><a href="#__codelineno-0-1670">1670</a></span>
<span class="normal"><a href="#__codelineno-0-1671">1671</a></span>
<span class="normal"><a href="#__codelineno-0-1672">1672</a></span>
<span class="normal"><a href="#__codelineno-0-1673">1673</a></span>
<span class="normal"><a href="#__codelineno-0-1674">1674</a></span>
<span class="normal"><a href="#__codelineno-0-1675">1675</a></span>
<span class="normal"><a href="#__codelineno-0-1676">1676</a></span>
<span class="normal"><a href="#__codelineno-0-1677">1677</a></span>
<span class="normal"><a href="#__codelineno-0-1678">1678</a></span>
<span class="normal"><a href="#__codelineno-0-1679">1679</a></span>
<span class="normal"><a href="#__codelineno-0-1680">1680</a></span>
<span class="normal"><a href="#__codelineno-0-1681">1681</a></span>
<span class="normal"><a href="#__codelineno-0-1682">1682</a></span>
<span class="normal"><a href="#__codelineno-0-1683">1683</a></span>
<span class="normal"><a href="#__codelineno-0-1684">1684</a></span>
<span class="normal"><a href="#__codelineno-0-1685">1685</a></span>
<span class="normal"><a href="#__codelineno-0-1686">1686</a></span>
<span class="normal"><a href="#__codelineno-0-1687">1687</a></span>
<span class="normal"><a href="#__codelineno-0-1688">1688</a></span>
<span class="normal"><a href="#__codelineno-0-1689">1689</a></span>
<span class="normal"><a href="#__codelineno-0-1690">1690</a></span>
<span class="normal"><a href="#__codelineno-0-1691">1691</a></span>
<span class="normal"><a href="#__codelineno-0-1692">1692</a></span>
<span class="normal"><a href="#__codelineno-0-1693">1693</a></span>
<span class="normal"><a href="#__codelineno-0-1694">1694</a></span>
<span class="normal"><a href="#__codelineno-0-1695">1695</a></span>
<span class="normal"><a href="#__codelineno-0-1696">1696</a></span>
<span class="normal"><a href="#__codelineno-0-1697">1697</a></span>
<span class="normal"><a href="#__codelineno-0-1698">1698</a></span>
<span class="normal"><a href="#__codelineno-0-1699">1699</a></span>
<span class="normal"><a href="#__codelineno-0-1700">1700</a></span>
<span class="normal"><a href="#__codelineno-0-1701">1701</a></span>
<span class="normal"><a href="#__codelineno-0-1702">1702</a></span>
<span class="normal"><a href="#__codelineno-0-1703">1703</a></span>
<span class="normal"><a href="#__codelineno-0-1704">1704</a></span>
<span class="normal"><a href="#__codelineno-0-1705">1705</a></span>
<span class="normal"><a href="#__codelineno-0-1706">1706</a></span>
<span class="normal"><a href="#__codelineno-0-1707">1707</a></span>
<span class="normal"><a href="#__codelineno-0-1708">1708</a></span>
<span class="normal"><a href="#__codelineno-0-1709">1709</a></span>
<span class="normal"><a href="#__codelineno-0-1710">1710</a></span>
<span class="normal"><a href="#__codelineno-0-1711">1711</a></span>
<span class="normal"><a href="#__codelineno-0-1712">1712</a></span>
<span class="normal"><a href="#__codelineno-0-1713">1713</a></span>
<span class="normal"><a href="#__codelineno-0-1714">1714</a></span>
<span class="normal"><a href="#__codelineno-0-1715">1715</a></span>
<span class="normal"><a href="#__codelineno-0-1716">1716</a></span>
<span class="normal"><a href="#__codelineno-0-1717">1717</a></span>
<span class="normal"><a href="#__codelineno-0-1718">1718</a></span>
<span class="normal"><a href="#__codelineno-0-1719">1719</a></span>
<span class="normal"><a href="#__codelineno-0-1720">1720</a></span>
<span class="normal"><a href="#__codelineno-0-1721">1721</a></span>
<span class="normal"><a href="#__codelineno-0-1722">1722</a></span>
<span class="normal"><a href="#__codelineno-0-1723">1723</a></span>
<span class="normal"><a href="#__codelineno-0-1724">1724</a></span>
<span class="normal"><a href="#__codelineno-0-1725">1725</a></span>
<span class="normal"><a href="#__codelineno-0-1726">1726</a></span>
<span class="normal"><a href="#__codelineno-0-1727">1727</a></span>
<span class="normal"><a href="#__codelineno-0-1728">1728</a></span>
<span class="normal"><a href="#__codelineno-0-1729">1729</a></span>
<span class="normal"><a href="#__codelineno-0-1730">1730</a></span>
<span class="normal"><a href="#__codelineno-0-1731">1731</a></span>
<span class="normal"><a href="#__codelineno-0-1732">1732</a></span>
<span class="normal"><a href="#__codelineno-0-1733">1733</a></span>
<span class="normal"><a href="#__codelineno-0-1734">1734</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1461" name="__codelineno-0-1461"></a><span class="k">class</span><span class="w"> </span><span class="nc">_StrictMetricsEvaluator</span><span class="p">(</span><span class="n">_MetricsEvaluator</span><span class="p">):</span>
<a id="__codelineno-0-1462" name="__codelineno-0-1462"></a>    <span class="n">struct</span><span class="p">:</span> <span class="n">StructType</span>
<a id="__codelineno-0-1463" name="__codelineno-0-1463"></a>    <span class="n">expr</span><span class="p">:</span> <span class="n">BooleanExpression</span>
<a id="__codelineno-0-1464" name="__codelineno-0-1464"></a>
<a id="__codelineno-0-1465" name="__codelineno-0-1465"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-1466" name="__codelineno-0-1466"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">Schema</span><span class="p">,</span> <span class="n">expr</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">,</span> <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">include_empty_files</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1467" name="__codelineno-0-1467"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1468" name="__codelineno-0-1468"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">struct</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">as_struct</span><span class="p">()</span>
<a id="__codelineno-0-1469" name="__codelineno-0-1469"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">include_empty_files</span> <span class="o">=</span> <span class="n">include_empty_files</span>
<a id="__codelineno-0-1470" name="__codelineno-0-1470"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">expr</span> <span class="o">=</span> <span class="n">bind</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">rewrite_not</span><span class="p">(</span><span class="n">expr</span><span class="p">),</span> <span class="n">case_sensitive</span><span class="p">)</span>
<a id="__codelineno-0-1471" name="__codelineno-0-1471"></a>
<a id="__codelineno-0-1472" name="__codelineno-0-1472"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="n">DataFile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1473" name="__codelineno-0-1473"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Test whether all records within the file match the expression.</span>
<a id="__codelineno-0-1474" name="__codelineno-0-1474"></a>
<a id="__codelineno-0-1475" name="__codelineno-0-1475"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1476" name="__codelineno-0-1476"></a><span class="sd">            file: A data file</span>
<a id="__codelineno-0-1477" name="__codelineno-0-1477"></a>
<a id="__codelineno-0-1478" name="__codelineno-0-1478"></a><span class="sd">        Returns: false if the file may contain any row that doesn&#39;t match</span>
<a id="__codelineno-0-1479" name="__codelineno-0-1479"></a><span class="sd">                    the expression, true otherwise.</span>
<a id="__codelineno-0-1480" name="__codelineno-0-1480"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1481" name="__codelineno-0-1481"></a>        <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">record_count</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1482" name="__codelineno-0-1482"></a>            <span class="c1"># Older version don&#39;t correctly implement record count from avro file and thus</span>
<a id="__codelineno-0-1483" name="__codelineno-0-1483"></a>            <span class="c1"># set record count -1 when importing avro tables to iceberg tables. This should</span>
<a id="__codelineno-0-1484" name="__codelineno-0-1484"></a>            <span class="c1"># be updated once we implemented and set correct record count.</span>
<a id="__codelineno-0-1485" name="__codelineno-0-1485"></a>            <span class="k">return</span> <span class="n">ROWS_MUST_MATCH</span>
<a id="__codelineno-0-1486" name="__codelineno-0-1486"></a>
<a id="__codelineno-0-1487" name="__codelineno-0-1487"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value_counts</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">value_counts</span> <span class="ow">or</span> <span class="n">EMPTY_DICT</span>
<a id="__codelineno-0-1488" name="__codelineno-0-1488"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">null_counts</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">null_value_counts</span> <span class="ow">or</span> <span class="n">EMPTY_DICT</span>
<a id="__codelineno-0-1489" name="__codelineno-0-1489"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nan_counts</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">nan_value_counts</span> <span class="ow">or</span> <span class="n">EMPTY_DICT</span>
<a id="__codelineno-0-1490" name="__codelineno-0-1490"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lower_bounds</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">lower_bounds</span> <span class="ow">or</span> <span class="n">EMPTY_DICT</span>
<a id="__codelineno-0-1491" name="__codelineno-0-1491"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">upper_bounds</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">upper_bounds</span> <span class="ow">or</span> <span class="n">EMPTY_DICT</span>
<a id="__codelineno-0-1492" name="__codelineno-0-1492"></a>
<a id="__codelineno-0-1493" name="__codelineno-0-1493"></a>        <span class="k">return</span> <span class="n">visit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expr</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-1494" name="__codelineno-0-1494"></a>
<a id="__codelineno-0-1495" name="__codelineno-0-1495"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_is_null</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1496" name="__codelineno-0-1496"></a>        <span class="c1"># no need to check whether the field is required because binding evaluates that case</span>
<a id="__codelineno-0-1497" name="__codelineno-0-1497"></a>        <span class="c1"># if the column has any non-null values, the expression does not match</span>
<a id="__codelineno-0-1498" name="__codelineno-0-1498"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1499" name="__codelineno-0-1499"></a>
<a id="__codelineno-0-1500" name="__codelineno-0-1500"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_nulls_only</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1501" name="__codelineno-0-1501"></a>            <span class="k">return</span> <span class="n">ROWS_MUST_MATCH</span>
<a id="__codelineno-0-1502" name="__codelineno-0-1502"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1503" name="__codelineno-0-1503"></a>            <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1504" name="__codelineno-0-1504"></a>
<a id="__codelineno-0-1505" name="__codelineno-0-1505"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not_null</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1506" name="__codelineno-0-1506"></a>        <span class="c1"># no need to check whether the field is required because binding evaluates that case</span>
<a id="__codelineno-0-1507" name="__codelineno-0-1507"></a>        <span class="c1"># if the column has any non-null values, the expression does not match</span>
<a id="__codelineno-0-1508" name="__codelineno-0-1508"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1509" name="__codelineno-0-1509"></a>
<a id="__codelineno-0-1510" name="__codelineno-0-1510"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">null_count</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">null_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">null_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1511" name="__codelineno-0-1511"></a>            <span class="k">return</span> <span class="n">ROWS_MUST_MATCH</span>
<a id="__codelineno-0-1512" name="__codelineno-0-1512"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1513" name="__codelineno-0-1513"></a>            <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1514" name="__codelineno-0-1514"></a>
<a id="__codelineno-0-1515" name="__codelineno-0-1515"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_is_nan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1516" name="__codelineno-0-1516"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1517" name="__codelineno-0-1517"></a>
<a id="__codelineno-0-1518" name="__codelineno-0-1518"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_nans_only</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1519" name="__codelineno-0-1519"></a>            <span class="k">return</span> <span class="n">ROWS_MUST_MATCH</span>
<a id="__codelineno-0-1520" name="__codelineno-0-1520"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1521" name="__codelineno-0-1521"></a>            <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1522" name="__codelineno-0-1522"></a>
<a id="__codelineno-0-1523" name="__codelineno-0-1523"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not_nan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1524" name="__codelineno-0-1524"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1525" name="__codelineno-0-1525"></a>
<a id="__codelineno-0-1526" name="__codelineno-0-1526"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">nan_count</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nan_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">nan_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1527" name="__codelineno-0-1527"></a>            <span class="k">return</span> <span class="n">ROWS_MUST_MATCH</span>
<a id="__codelineno-0-1528" name="__codelineno-0-1528"></a>
<a id="__codelineno-0-1529" name="__codelineno-0-1529"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_nulls_only</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1530" name="__codelineno-0-1530"></a>            <span class="k">return</span> <span class="n">ROWS_MUST_MATCH</span>
<a id="__codelineno-0-1531" name="__codelineno-0-1531"></a>
<a id="__codelineno-0-1532" name="__codelineno-0-1532"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1533" name="__codelineno-0-1533"></a>
<a id="__codelineno-0-1534" name="__codelineno-0-1534"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_less_than</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1535" name="__codelineno-0-1535"></a>        <span class="c1"># Rows must match when: &lt;----------Min----Max---X-------&gt;</span>
<a id="__codelineno-0-1536" name="__codelineno-0-1536"></a>
<a id="__codelineno-0-1537" name="__codelineno-0-1537"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1538" name="__codelineno-0-1538"></a>
<a id="__codelineno-0-1539" name="__codelineno-0-1539"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_can_contain_nulls</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_can_contain_nans</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1540" name="__codelineno-0-1540"></a>            <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1541" name="__codelineno-0-1541"></a>
<a id="__codelineno-0-1542" name="__codelineno-0-1542"></a>        <span class="k">if</span> <span class="n">upper_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1543" name="__codelineno-0-1543"></a>            <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_field</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span>
<a id="__codelineno-0-1544" name="__codelineno-0-1544"></a>            <span class="n">upper</span> <span class="o">=</span> <span class="n">_from_byte_buffer</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">upper_bytes</span><span class="p">)</span>
<a id="__codelineno-0-1545" name="__codelineno-0-1545"></a>
<a id="__codelineno-0-1546" name="__codelineno-0-1546"></a>            <span class="k">if</span> <span class="n">upper</span> <span class="o">&lt;</span> <span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1547" name="__codelineno-0-1547"></a>                <span class="k">return</span> <span class="n">ROWS_MUST_MATCH</span>
<a id="__codelineno-0-1548" name="__codelineno-0-1548"></a>
<a id="__codelineno-0-1549" name="__codelineno-0-1549"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1550" name="__codelineno-0-1550"></a>
<a id="__codelineno-0-1551" name="__codelineno-0-1551"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_less_than_or_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1552" name="__codelineno-0-1552"></a>        <span class="c1"># Rows must match when: &lt;----------Min----Max---X-------&gt;</span>
<a id="__codelineno-0-1553" name="__codelineno-0-1553"></a>
<a id="__codelineno-0-1554" name="__codelineno-0-1554"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1555" name="__codelineno-0-1555"></a>
<a id="__codelineno-0-1556" name="__codelineno-0-1556"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_can_contain_nulls</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_can_contain_nans</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1557" name="__codelineno-0-1557"></a>            <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1558" name="__codelineno-0-1558"></a>
<a id="__codelineno-0-1559" name="__codelineno-0-1559"></a>        <span class="k">if</span> <span class="n">upper_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1560" name="__codelineno-0-1560"></a>            <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_field</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span>
<a id="__codelineno-0-1561" name="__codelineno-0-1561"></a>            <span class="n">upper</span> <span class="o">=</span> <span class="n">_from_byte_buffer</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">upper_bytes</span><span class="p">)</span>
<a id="__codelineno-0-1562" name="__codelineno-0-1562"></a>
<a id="__codelineno-0-1563" name="__codelineno-0-1563"></a>            <span class="k">if</span> <span class="n">upper</span> <span class="o">&lt;=</span> <span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1564" name="__codelineno-0-1564"></a>                <span class="k">return</span> <span class="n">ROWS_MUST_MATCH</span>
<a id="__codelineno-0-1565" name="__codelineno-0-1565"></a>
<a id="__codelineno-0-1566" name="__codelineno-0-1566"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1567" name="__codelineno-0-1567"></a>
<a id="__codelineno-0-1568" name="__codelineno-0-1568"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_greater_than</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1569" name="__codelineno-0-1569"></a>        <span class="c1"># Rows must match when: &lt;-------X---Min----Max----------&gt;</span>
<a id="__codelineno-0-1570" name="__codelineno-0-1570"></a>
<a id="__codelineno-0-1571" name="__codelineno-0-1571"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1572" name="__codelineno-0-1572"></a>
<a id="__codelineno-0-1573" name="__codelineno-0-1573"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_can_contain_nulls</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_can_contain_nans</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1574" name="__codelineno-0-1574"></a>            <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1575" name="__codelineno-0-1575"></a>
<a id="__codelineno-0-1576" name="__codelineno-0-1576"></a>        <span class="k">if</span> <span class="n">lower_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1577" name="__codelineno-0-1577"></a>            <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_field</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span>
<a id="__codelineno-0-1578" name="__codelineno-0-1578"></a>            <span class="n">lower</span> <span class="o">=</span> <span class="n">_from_byte_buffer</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">lower_bytes</span><span class="p">)</span>
<a id="__codelineno-0-1579" name="__codelineno-0-1579"></a>
<a id="__codelineno-0-1580" name="__codelineno-0-1580"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_nan</span><span class="p">(</span><span class="n">lower</span><span class="p">):</span>
<a id="__codelineno-0-1581" name="__codelineno-0-1581"></a>                <span class="c1"># NaN indicates unreliable bounds.</span>
<a id="__codelineno-0-1582" name="__codelineno-0-1582"></a>                <span class="c1"># See the _StrictMetricsEvaluator docs for more.</span>
<a id="__codelineno-0-1583" name="__codelineno-0-1583"></a>                <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1584" name="__codelineno-0-1584"></a>
<a id="__codelineno-0-1585" name="__codelineno-0-1585"></a>            <span class="k">if</span> <span class="n">lower</span> <span class="o">&gt;</span> <span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1586" name="__codelineno-0-1586"></a>                <span class="k">return</span> <span class="n">ROWS_MUST_MATCH</span>
<a id="__codelineno-0-1587" name="__codelineno-0-1587"></a>
<a id="__codelineno-0-1588" name="__codelineno-0-1588"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1589" name="__codelineno-0-1589"></a>
<a id="__codelineno-0-1590" name="__codelineno-0-1590"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_greater_than_or_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1591" name="__codelineno-0-1591"></a>        <span class="c1"># Rows must match when: &lt;-------X---Min----Max----------&gt;</span>
<a id="__codelineno-0-1592" name="__codelineno-0-1592"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1593" name="__codelineno-0-1593"></a>
<a id="__codelineno-0-1594" name="__codelineno-0-1594"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_can_contain_nulls</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_can_contain_nans</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1595" name="__codelineno-0-1595"></a>            <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1596" name="__codelineno-0-1596"></a>
<a id="__codelineno-0-1597" name="__codelineno-0-1597"></a>        <span class="k">if</span> <span class="n">lower_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1598" name="__codelineno-0-1598"></a>            <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_field</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span>
<a id="__codelineno-0-1599" name="__codelineno-0-1599"></a>            <span class="n">lower</span> <span class="o">=</span> <span class="n">_from_byte_buffer</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">lower_bytes</span><span class="p">)</span>
<a id="__codelineno-0-1600" name="__codelineno-0-1600"></a>
<a id="__codelineno-0-1601" name="__codelineno-0-1601"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_nan</span><span class="p">(</span><span class="n">lower</span><span class="p">):</span>
<a id="__codelineno-0-1602" name="__codelineno-0-1602"></a>                <span class="c1"># NaN indicates unreliable bounds.</span>
<a id="__codelineno-0-1603" name="__codelineno-0-1603"></a>                <span class="c1"># See the _StrictMetricsEvaluator docs for more.</span>
<a id="__codelineno-0-1604" name="__codelineno-0-1604"></a>                <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1605" name="__codelineno-0-1605"></a>
<a id="__codelineno-0-1606" name="__codelineno-0-1606"></a>            <span class="k">if</span> <span class="n">lower</span> <span class="o">&gt;=</span> <span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1607" name="__codelineno-0-1607"></a>                <span class="k">return</span> <span class="n">ROWS_MUST_MATCH</span>
<a id="__codelineno-0-1608" name="__codelineno-0-1608"></a>
<a id="__codelineno-0-1609" name="__codelineno-0-1609"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1610" name="__codelineno-0-1610"></a>
<a id="__codelineno-0-1611" name="__codelineno-0-1611"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1612" name="__codelineno-0-1612"></a>        <span class="c1"># Rows must match when Min == X == Max</span>
<a id="__codelineno-0-1613" name="__codelineno-0-1613"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1614" name="__codelineno-0-1614"></a>
<a id="__codelineno-0-1615" name="__codelineno-0-1615"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_can_contain_nulls</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_can_contain_nans</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1616" name="__codelineno-0-1616"></a>            <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1617" name="__codelineno-0-1617"></a>
<a id="__codelineno-0-1618" name="__codelineno-0-1618"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">lower_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">upper_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">)):</span>
<a id="__codelineno-0-1619" name="__codelineno-0-1619"></a>            <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_field</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span>
<a id="__codelineno-0-1620" name="__codelineno-0-1620"></a>            <span class="n">lower</span> <span class="o">=</span> <span class="n">_from_byte_buffer</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">lower_bytes</span><span class="p">)</span>
<a id="__codelineno-0-1621" name="__codelineno-0-1621"></a>            <span class="n">upper</span> <span class="o">=</span> <span class="n">_from_byte_buffer</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">upper_bytes</span><span class="p">)</span>
<a id="__codelineno-0-1622" name="__codelineno-0-1622"></a>
<a id="__codelineno-0-1623" name="__codelineno-0-1623"></a>            <span class="k">if</span> <span class="n">lower</span> <span class="o">!=</span> <span class="n">literal</span><span class="o">.</span><span class="n">value</span> <span class="ow">or</span> <span class="n">upper</span> <span class="o">!=</span> <span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1624" name="__codelineno-0-1624"></a>                <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1625" name="__codelineno-0-1625"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1626" name="__codelineno-0-1626"></a>                <span class="k">return</span> <span class="n">ROWS_MUST_MATCH</span>
<a id="__codelineno-0-1627" name="__codelineno-0-1627"></a>
<a id="__codelineno-0-1628" name="__codelineno-0-1628"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1629" name="__codelineno-0-1629"></a>
<a id="__codelineno-0-1630" name="__codelineno-0-1630"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1631" name="__codelineno-0-1631"></a>        <span class="c1"># Rows must match when X &lt; Min or Max &lt; X because it is not in the range</span>
<a id="__codelineno-0-1632" name="__codelineno-0-1632"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1633" name="__codelineno-0-1633"></a>
<a id="__codelineno-0-1634" name="__codelineno-0-1634"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_can_contain_nulls</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_can_contain_nans</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1635" name="__codelineno-0-1635"></a>            <span class="k">return</span> <span class="n">ROWS_MUST_MATCH</span>
<a id="__codelineno-0-1636" name="__codelineno-0-1636"></a>
<a id="__codelineno-0-1637" name="__codelineno-0-1637"></a>        <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_field</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span>
<a id="__codelineno-0-1638" name="__codelineno-0-1638"></a>
<a id="__codelineno-0-1639" name="__codelineno-0-1639"></a>        <span class="k">if</span> <span class="n">lower_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1640" name="__codelineno-0-1640"></a>            <span class="n">lower</span> <span class="o">=</span> <span class="n">_from_byte_buffer</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">lower_bytes</span><span class="p">)</span>
<a id="__codelineno-0-1641" name="__codelineno-0-1641"></a>
<a id="__codelineno-0-1642" name="__codelineno-0-1642"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_nan</span><span class="p">(</span><span class="n">lower</span><span class="p">):</span>
<a id="__codelineno-0-1643" name="__codelineno-0-1643"></a>                <span class="c1"># NaN indicates unreliable bounds.</span>
<a id="__codelineno-0-1644" name="__codelineno-0-1644"></a>                <span class="c1"># See the _StrictMetricsEvaluator docs for more.</span>
<a id="__codelineno-0-1645" name="__codelineno-0-1645"></a>                <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1646" name="__codelineno-0-1646"></a>
<a id="__codelineno-0-1647" name="__codelineno-0-1647"></a>            <span class="k">if</span> <span class="n">lower</span> <span class="o">&gt;</span> <span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1648" name="__codelineno-0-1648"></a>                <span class="k">return</span> <span class="n">ROWS_MUST_MATCH</span>
<a id="__codelineno-0-1649" name="__codelineno-0-1649"></a>
<a id="__codelineno-0-1650" name="__codelineno-0-1650"></a>        <span class="k">if</span> <span class="n">upper_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1651" name="__codelineno-0-1651"></a>            <span class="n">upper</span> <span class="o">=</span> <span class="n">_from_byte_buffer</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">upper_bytes</span><span class="p">)</span>
<a id="__codelineno-0-1652" name="__codelineno-0-1652"></a>
<a id="__codelineno-0-1653" name="__codelineno-0-1653"></a>            <span class="k">if</span> <span class="n">upper</span> <span class="o">&lt;</span> <span class="n">literal</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1654" name="__codelineno-0-1654"></a>                <span class="k">return</span> <span class="n">ROWS_MUST_MATCH</span>
<a id="__codelineno-0-1655" name="__codelineno-0-1655"></a>
<a id="__codelineno-0-1656" name="__codelineno-0-1656"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1657" name="__codelineno-0-1657"></a>
<a id="__codelineno-0-1658" name="__codelineno-0-1658"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literals</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1659" name="__codelineno-0-1659"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1660" name="__codelineno-0-1660"></a>
<a id="__codelineno-0-1661" name="__codelineno-0-1661"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_can_contain_nulls</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_can_contain_nans</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1662" name="__codelineno-0-1662"></a>            <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1663" name="__codelineno-0-1663"></a>
<a id="__codelineno-0-1664" name="__codelineno-0-1664"></a>        <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_field</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span>
<a id="__codelineno-0-1665" name="__codelineno-0-1665"></a>
<a id="__codelineno-0-1666" name="__codelineno-0-1666"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">lower_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">upper_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">)):</span>
<a id="__codelineno-0-1667" name="__codelineno-0-1667"></a>            <span class="c1"># similar to the implementation in eq, first check if the lower bound is in the set</span>
<a id="__codelineno-0-1668" name="__codelineno-0-1668"></a>            <span class="n">lower</span> <span class="o">=</span> <span class="n">_from_byte_buffer</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">lower_bytes</span><span class="p">)</span>
<a id="__codelineno-0-1669" name="__codelineno-0-1669"></a>            <span class="k">if</span> <span class="n">lower</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">literals</span><span class="p">:</span>
<a id="__codelineno-0-1670" name="__codelineno-0-1670"></a>                <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1671" name="__codelineno-0-1671"></a>
<a id="__codelineno-0-1672" name="__codelineno-0-1672"></a>            <span class="c1"># check if the upper bound is in the set</span>
<a id="__codelineno-0-1673" name="__codelineno-0-1673"></a>            <span class="n">upper</span> <span class="o">=</span> <span class="n">_from_byte_buffer</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">upper_bytes</span><span class="p">)</span>
<a id="__codelineno-0-1674" name="__codelineno-0-1674"></a>            <span class="k">if</span> <span class="n">upper</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">literals</span><span class="p">:</span>
<a id="__codelineno-0-1675" name="__codelineno-0-1675"></a>                <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1676" name="__codelineno-0-1676"></a>
<a id="__codelineno-0-1677" name="__codelineno-0-1677"></a>            <span class="c1"># finally check if the lower bound and the upper bound are equal</span>
<a id="__codelineno-0-1678" name="__codelineno-0-1678"></a>            <span class="k">if</span> <span class="n">lower</span> <span class="o">!=</span> <span class="n">upper</span><span class="p">:</span>
<a id="__codelineno-0-1679" name="__codelineno-0-1679"></a>                <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1680" name="__codelineno-0-1680"></a>
<a id="__codelineno-0-1681" name="__codelineno-0-1681"></a>            <span class="c1"># All values must be in the set if the lower bound and the upper bound are</span>
<a id="__codelineno-0-1682" name="__codelineno-0-1682"></a>            <span class="c1"># in the set and are equal.</span>
<a id="__codelineno-0-1683" name="__codelineno-0-1683"></a>            <span class="k">return</span> <span class="n">ROWS_MUST_MATCH</span>
<a id="__codelineno-0-1684" name="__codelineno-0-1684"></a>
<a id="__codelineno-0-1685" name="__codelineno-0-1685"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1686" name="__codelineno-0-1686"></a>
<a id="__codelineno-0-1687" name="__codelineno-0-1687"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literals</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1688" name="__codelineno-0-1688"></a>        <span class="n">field_id</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">field_id</span>
<a id="__codelineno-0-1689" name="__codelineno-0-1689"></a>
<a id="__codelineno-0-1690" name="__codelineno-0-1690"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_can_contain_nulls</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_can_contain_nans</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1691" name="__codelineno-0-1691"></a>            <span class="k">return</span> <span class="n">ROWS_MUST_MATCH</span>
<a id="__codelineno-0-1692" name="__codelineno-0-1692"></a>
<a id="__codelineno-0-1693" name="__codelineno-0-1693"></a>        <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_field</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span>
<a id="__codelineno-0-1694" name="__codelineno-0-1694"></a>
<a id="__codelineno-0-1695" name="__codelineno-0-1695"></a>        <span class="k">if</span> <span class="n">lower_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1696" name="__codelineno-0-1696"></a>            <span class="n">lower</span> <span class="o">=</span> <span class="n">_from_byte_buffer</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">lower_bytes</span><span class="p">)</span>
<a id="__codelineno-0-1697" name="__codelineno-0-1697"></a>
<a id="__codelineno-0-1698" name="__codelineno-0-1698"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_nan</span><span class="p">(</span><span class="n">lower</span><span class="p">):</span>
<a id="__codelineno-0-1699" name="__codelineno-0-1699"></a>                <span class="c1"># NaN indicates unreliable bounds.</span>
<a id="__codelineno-0-1700" name="__codelineno-0-1700"></a>                <span class="c1"># See the StrictMetricsEvaluator docs for more.</span>
<a id="__codelineno-0-1701" name="__codelineno-0-1701"></a>                <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1702" name="__codelineno-0-1702"></a>
<a id="__codelineno-0-1703" name="__codelineno-0-1703"></a>            <span class="n">literals</span> <span class="o">=</span> <span class="p">{</span><span class="n">val</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">literals</span> <span class="k">if</span> <span class="n">lower</span> <span class="o">&lt;=</span> <span class="n">val</span><span class="p">}</span>
<a id="__codelineno-0-1704" name="__codelineno-0-1704"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">literals</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1705" name="__codelineno-0-1705"></a>                <span class="k">return</span> <span class="n">ROWS_MUST_MATCH</span>
<a id="__codelineno-0-1706" name="__codelineno-0-1706"></a>
<a id="__codelineno-0-1707" name="__codelineno-0-1707"></a>        <span class="k">if</span> <span class="n">upper_bytes</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_bounds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">):</span>
<a id="__codelineno-0-1708" name="__codelineno-0-1708"></a>            <span class="n">upper</span> <span class="o">=</span> <span class="n">_from_byte_buffer</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="p">,</span> <span class="n">upper_bytes</span><span class="p">)</span>
<a id="__codelineno-0-1709" name="__codelineno-0-1709"></a>
<a id="__codelineno-0-1710" name="__codelineno-0-1710"></a>            <span class="n">literals</span> <span class="o">=</span> <span class="p">{</span><span class="n">val</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">literals</span> <span class="k">if</span> <span class="n">upper</span> <span class="o">&gt;=</span> <span class="n">val</span><span class="p">}</span>
<a id="__codelineno-0-1711" name="__codelineno-0-1711"></a>
<a id="__codelineno-0-1712" name="__codelineno-0-1712"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">literals</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1713" name="__codelineno-0-1713"></a>                <span class="k">return</span> <span class="n">ROWS_MUST_MATCH</span>
<a id="__codelineno-0-1714" name="__codelineno-0-1714"></a>
<a id="__codelineno-0-1715" name="__codelineno-0-1715"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1716" name="__codelineno-0-1716"></a>
<a id="__codelineno-0-1717" name="__codelineno-0-1717"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_starts_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1718" name="__codelineno-0-1718"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1719" name="__codelineno-0-1719"></a>
<a id="__codelineno-0-1720" name="__codelineno-0-1720"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visit_not_starts_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">BoundTerm</span><span class="p">[</span><span class="n">L</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">L</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1721" name="__codelineno-0-1721"></a>        <span class="k">return</span> <span class="n">ROWS_MIGHT_NOT_MATCH</span>
<a id="__codelineno-0-1722" name="__codelineno-0-1722"></a>
<a id="__codelineno-0-1723" name="__codelineno-0-1723"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NestedField</span><span class="p">:</span>
<a id="__codelineno-0-1724" name="__codelineno-0-1724"></a>        <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">struct</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">field_id</span><span class="o">=</span><span class="n">field_id</span><span class="p">)</span>
<a id="__codelineno-0-1725" name="__codelineno-0-1725"></a>        <span class="k">if</span> <span class="n">field</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1726" name="__codelineno-0-1726"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot find field, might be nested or missing: </span><span class="si">{</span><span class="n">field_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1727" name="__codelineno-0-1727"></a>
<a id="__codelineno-0-1728" name="__codelineno-0-1728"></a>        <span class="k">return</span> <span class="n">field</span>
<a id="__codelineno-0-1729" name="__codelineno-0-1729"></a>
<a id="__codelineno-0-1730" name="__codelineno-0-1730"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_can_contain_nulls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1731" name="__codelineno-0-1731"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">null_count</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">null_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">null_count</span> <span class="o">&gt;</span> <span class="mi">0</span>
<a id="__codelineno-0-1732" name="__codelineno-0-1732"></a>
<a id="__codelineno-0-1733" name="__codelineno-0-1733"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_can_contain_nans</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1734" name="__codelineno-0-1734"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">nan_count</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nan_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_id</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">nan_count</span> <span class="o">&gt;</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pyiceberg.expressions.visitors._StrictMetricsEvaluator.eval" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">eval</span><span class="p">(</span><span class="n">file</span><span class="p">)</span></code>

<a href="#pyiceberg.expressions.visitors._StrictMetricsEvaluator.eval" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test whether all records within the file match the expression.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="pyiceberg.manifest.DataFile" href="../../manifest/#pyiceberg.manifest.DataFile">DataFile</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A data file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">false if the file may contain any row that doesn&#39;t match</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the expression, true otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1472">1472</a></span>
<span class="normal"><a href="#__codelineno-0-1473">1473</a></span>
<span class="normal"><a href="#__codelineno-0-1474">1474</a></span>
<span class="normal"><a href="#__codelineno-0-1475">1475</a></span>
<span class="normal"><a href="#__codelineno-0-1476">1476</a></span>
<span class="normal"><a href="#__codelineno-0-1477">1477</a></span>
<span class="normal"><a href="#__codelineno-0-1478">1478</a></span>
<span class="normal"><a href="#__codelineno-0-1479">1479</a></span>
<span class="normal"><a href="#__codelineno-0-1480">1480</a></span>
<span class="normal"><a href="#__codelineno-0-1481">1481</a></span>
<span class="normal"><a href="#__codelineno-0-1482">1482</a></span>
<span class="normal"><a href="#__codelineno-0-1483">1483</a></span>
<span class="normal"><a href="#__codelineno-0-1484">1484</a></span>
<span class="normal"><a href="#__codelineno-0-1485">1485</a></span>
<span class="normal"><a href="#__codelineno-0-1486">1486</a></span>
<span class="normal"><a href="#__codelineno-0-1487">1487</a></span>
<span class="normal"><a href="#__codelineno-0-1488">1488</a></span>
<span class="normal"><a href="#__codelineno-0-1489">1489</a></span>
<span class="normal"><a href="#__codelineno-0-1490">1490</a></span>
<span class="normal"><a href="#__codelineno-0-1491">1491</a></span>
<span class="normal"><a href="#__codelineno-0-1492">1492</a></span>
<span class="normal"><a href="#__codelineno-0-1493">1493</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1472" name="__codelineno-0-1472"></a><span class="k">def</span><span class="w"> </span><span class="nf">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="n">DataFile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1473" name="__codelineno-0-1473"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test whether all records within the file match the expression.</span>
<a id="__codelineno-0-1474" name="__codelineno-0-1474"></a>
<a id="__codelineno-0-1475" name="__codelineno-0-1475"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1476" name="__codelineno-0-1476"></a><span class="sd">        file: A data file</span>
<a id="__codelineno-0-1477" name="__codelineno-0-1477"></a>
<a id="__codelineno-0-1478" name="__codelineno-0-1478"></a><span class="sd">    Returns: false if the file may contain any row that doesn&#39;t match</span>
<a id="__codelineno-0-1479" name="__codelineno-0-1479"></a><span class="sd">                the expression, true otherwise.</span>
<a id="__codelineno-0-1480" name="__codelineno-0-1480"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1481" name="__codelineno-0-1481"></a>    <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">record_count</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1482" name="__codelineno-0-1482"></a>        <span class="c1"># Older version don&#39;t correctly implement record count from avro file and thus</span>
<a id="__codelineno-0-1483" name="__codelineno-0-1483"></a>        <span class="c1"># set record count -1 when importing avro tables to iceberg tables. This should</span>
<a id="__codelineno-0-1484" name="__codelineno-0-1484"></a>        <span class="c1"># be updated once we implemented and set correct record count.</span>
<a id="__codelineno-0-1485" name="__codelineno-0-1485"></a>        <span class="k">return</span> <span class="n">ROWS_MUST_MATCH</span>
<a id="__codelineno-0-1486" name="__codelineno-0-1486"></a>
<a id="__codelineno-0-1487" name="__codelineno-0-1487"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">value_counts</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">value_counts</span> <span class="ow">or</span> <span class="n">EMPTY_DICT</span>
<a id="__codelineno-0-1488" name="__codelineno-0-1488"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">null_counts</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">null_value_counts</span> <span class="ow">or</span> <span class="n">EMPTY_DICT</span>
<a id="__codelineno-0-1489" name="__codelineno-0-1489"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">nan_counts</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">nan_value_counts</span> <span class="ow">or</span> <span class="n">EMPTY_DICT</span>
<a id="__codelineno-0-1490" name="__codelineno-0-1490"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">lower_bounds</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">lower_bounds</span> <span class="ow">or</span> <span class="n">EMPTY_DICT</span>
<a id="__codelineno-0-1491" name="__codelineno-0-1491"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">upper_bounds</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">upper_bounds</span> <span class="ow">or</span> <span class="n">EMPTY_DICT</span>
<a id="__codelineno-0-1492" name="__codelineno-0-1492"></a>
<a id="__codelineno-0-1493" name="__codelineno-0-1493"></a>    <span class="k">return</span> <span class="n">visit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expr</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="pyiceberg.expressions.visitors.bind" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bind</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">case_sensitive</span><span class="p">)</span></code>

<a href="#pyiceberg.expressions.visitors.bind" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Travers over an expression to bind the predicates to the schema.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="pyiceberg.schema.Schema" href="../../schema/#pyiceberg.schema.Schema">Schema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A schema to use when binding the expression.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>expression</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="pyiceberg.expressions.BooleanExpression" href="../#pyiceberg.expressions.BooleanExpression">BooleanExpression</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An expression containing UnboundPredicates that can be bound.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>case_sensitive</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to consider case when binding a reference to a field in a schema, defaults to True.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>In the case a predicate is already bound.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="k">def</span><span class="w"> </span><span class="nf">bind</span><span class="p">(</span><span class="n">schema</span><span class="p">:</span> <span class="n">Schema</span><span class="p">,</span> <span class="n">expression</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">,</span> <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BooleanExpression</span><span class="p">:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Travers over an expression to bind the predicates to the schema.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">      schema (Schema): A schema to use when binding the expression.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">      expression (BooleanExpression): An expression containing UnboundPredicates that can be bound.</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">      case_sensitive (bool): Whether to consider case when binding a reference to a field in a schema, defaults to True.</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        TypeError: In the case a predicate is already bound.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="k">return</span> <span class="n">visit</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">BindVisitor</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">case_sensitive</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyiceberg.expressions.visitors.expression_to_plain_format" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">expression_to_plain_format</span><span class="p">(</span><span class="n">expressions</span><span class="p">,</span> <span class="n">cast_int_to_datetime</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#pyiceberg.expressions.visitors.expression_to_plain_format" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Format a Disjunctive Normal Form expression.</p>
<p>These are the formats that the expression can be fed into:</p>
<ul>
<li>https://arrow.apache.org/docs/python/generated/pyarrow.parquet.read_table.html</li>
<li>https://docs.dask.org/en/stable/generated/dask.dataframe.read_parquet.html</li>
</ul>
<p>Contrary to normal DNF that may contain Not expressions, but here they should have
been rewritten. This can be done using <code>rewrite_not(...)</code>.</p>
<p>Keep in mind that this is only used for page skipping, and still needs to filter
on a row level.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>expressions</code>
            </td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<a class="autorefs autorefs-internal" title="pyiceberg.expressions.BooleanExpression" href="../#pyiceberg.expressions.BooleanExpression">BooleanExpression</a>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Expression in Disjunctive Normal Form.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[<span title="str">str</span>, <span title="str">str</span>, <span title="typing.Any">Any</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Formatter filter compatible with Dask and PyArrow.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="k">def</span><span class="w"> </span><span class="nf">expression_to_plain_format</span><span class="p">(</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a>    <span class="n">expressions</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">BooleanExpression</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">cast_int_to_datetime</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Format a Disjunctive Normal Form expression.</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a><span class="sd">    These are the formats that the expression can be fed into:</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><span class="sd">    - https://arrow.apache.org/docs/python/generated/pyarrow.parquet.read_table.html</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="sd">    - https://docs.dask.org/en/stable/generated/dask.dataframe.read_parquet.html</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a><span class="sd">    Contrary to normal DNF that may contain Not expressions, but here they should have</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a><span class="sd">    been rewritten. This can be done using ``rewrite_not(...)``.</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><span class="sd">    Keep in mind that this is only used for page skipping, and still needs to filter</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="sd">    on a row level.</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a><span class="sd">        expressions: Expression in Disjunctive Normal Form.</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a><span class="sd">        Formatter filter compatible with Dask and PyArrow.</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>    <span class="c1"># In the form of expr1  expr2  ...  exprN</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>    <span class="n">visitor</span> <span class="o">=</span> <span class="n">ExpressionToPlainFormat</span><span class="p">(</span><span class="n">cast_int_to_datetime</span><span class="p">)</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">visit</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">visitor</span><span class="p">)</span> <span class="k">for</span> <span class="n">expression</span> <span class="ow">in</span> <span class="n">expressions</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyiceberg.expressions.visitors.visit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visit</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">visitor</span><span class="p">)</span></code>

<a href="#pyiceberg.expressions.visitors.visit" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Apply a boolean expression visitor to any point within an expression.</p>
<p>The function traverses the expression in post-order fashion.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>obj</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="pyiceberg.expressions.BooleanExpression" href="../#pyiceberg.expressions.BooleanExpression">BooleanExpression</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An instance of a BooleanExpression.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>visitor</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="pyiceberg.expressions.visitors.BooleanExpressionVisitor" href="#pyiceberg.expressions.visitors.BooleanExpressionVisitor">BooleanExpressionVisitor</a>[<span title="pyiceberg.expressions.visitors.T">T</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An instance of an implementation of the generic BooleanExpressionVisitor base class.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NotImplementedError">NotImplementedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If attempting to visit an unsupported expression.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyiceberg/expressions/visitors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="nd">@singledispatch</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="k">def</span><span class="w"> </span><span class="nf">visit</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">BooleanExpression</span><span class="p">,</span> <span class="n">visitor</span><span class="p">:</span> <span class="n">BooleanExpressionVisitor</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply a boolean expression visitor to any point within an expression.</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    The function traverses the expression in post-order fashion.</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        obj (BooleanExpression): An instance of a BooleanExpression.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">        visitor (BooleanExpressionVisitor[T]): An instance of an implementation of the generic BooleanExpressionVisitor base class.</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        NotImplementedError: If attempting to visit an unsupported expression.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot visit unsupported expression: </span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.top", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky"], "search": "../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>